<?xml version='1.0' encoding='us-ascii'?>   

<!DOCTYPE torture SYSTEM "torture.dtd" >

<!-- 

A set of torture tests for the SIP message parser.
These tests are in no particular order. 

The sources for these messages are 
1. Posting on the SIP Mailing list.
2. Henning Schulzrinne's SIP bakeoff page:
http://www.cs.columbia.edu/%7Ehgs/sip/bakeoff/testmsg.html
3. The call flows document draft-ietf-sip-call-flows-03.txt authored by Johnston et al.

4. the testcases extracted from draft-ietf-sipping-torture-tests-03.

	output-results = "true"
	jaintestlog="jainlog.txt"
	testlog = "testout.xml"
-->

<torture
	output-parsed-structures = "false" 
	output-results = "false"
	abort-on-fail = "true"
	debug = "false"
>

<testcase>

<!-- The following is the test description -->
<description>
<![CDATA[
1) Illegal enclosing of Request-URI  in Server should respond with 400 + Appropriate Reason Phrase.
]]>
</description>

<!-- The following is the test message -->
<message>
<![CDATA[INVITE <sip:user@company.com> SIP/2.0
From: <sip:caller@university.edu>
To: <sip:user@company.com>;tag=9
Via: SIP/2.0/UDP 135.180.130.133
CSeq:  1 INVITE
Content-Type: application/sdp
Call-ID: foo@10.0.0.1

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>

<!-- The following is the class of the exception that this should generate -->
<expect-exception-callback
  exception-class = "java.text.ParseException"
>

<!-- The exception-text (should be exact) is passed back to the exception handler -->
<exception-text>
<![CDATA[INVITE <sip:user@company.com> SIP/2.0]]>
</exception-text>
</expect-exception-callback>

</testcase>
<!-- This  test is from SIPIT 11 -->
<testcase>
<description>
<![CDATA[
sipit 11 : test case 1
]]>
</description>
<message>
<![CDATA[INVITE sip:littleguy@there.com:5060 SIP/2.0
Via: SIP/2.0/UDP 65.243.118.100:5050
From: M. Ranganathan  <sip:M.Ranganathan@sipbakeoff.com>
To: "littleguy@there.com" <sip:littleguy@there.com:5060>
Call-ID: Q2AboBsaGn9!?x6@sipbakeoff.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>

<!--  		test2 		 -->

<testcase>

<description>
<![CDATA[
2) Illegal LWS in elements of Request-URI Server should respond with 400 + Appropriate Reason Phrase.
]]>
</description>

<message>
<![CDATA[INVITE sip:user@company.com; transport=udp SIP/2.0
To: <sip:user@company.com>
From: <sip:caller@university.edu>
Call-ID: 2@10.0.0.1
CSeq: 1 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC


]]>
</message>

<expect-exception-callback
  exception-class = "java.text.ParseException"
>
<exception-text>
<![CDATA[INVITE sip:user@company.com; transport=udp SIP/2.0]]>
</exception-text>

</expect-exception-callback>

</testcase>

<!-- test3 				-->
<testcase>

<description>
<![CDATA[
3) Illegal >1 SP between elements of Request URI
Server should respond with 400 + Appropriate Reason Phrase.
]]>
</description>

<message>
<![CDATA[INVITE sip:user@company.com  SIP/2.0
To: sip:user@company.com
From: sip:caller@university.edu
Call-ID: 3@10.0.0.1
CSeq: 1 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC



]]>
</message>

<expect-exception-callback
  exception-class = "java.text.ParseException"
>

<exception-text>
<![CDATA[INVITE sip:user@company.com  SIP/2.0]]>
</exception-text>
</expect-exception-callback>
</testcase>


<!-- test4 				-->
<testcase>
<description>
<![CDATA[ 
4) A Legal exception-text with escape sequences in the request URI.  
]]>
</description>

<message>
<![CDATA[INVITE sip:sip%3Auser%40example.com@company.com;other-param=summit SIP/2.0
To: sip:user@company.com
From: sip:caller@university.edu
Call-ID: 4@10.0.0.1
CSeq: 1 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
</testcase>

<!-- test5 				-->
<testcase>
<description>
<![CDATA[
5) Illegal use of exception-text in Request-URI
Proxies should strip off the escaped exception-text before proxying on.     
]]>
</description>

<message>
<![CDATA[INVITE sip:user@company.com?Route=%3Csip:sip.example.com%3E SIP/2.0
To: sip:user@company.com
From: sip:caller@university.edu
Call-ID: 5@10.0.0.1
CSeq: 1 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC


]]>
</message>

<expect-exception-callback
  exception-class = "java.text.ParseException"
>

<exception-text>
<![CDATA[INVITE sip:user@company.com?Route=%3Csip:sip.example.com%3E SIP/2.0]]>
</exception-text>
</expect-exception-callback>
</testcase>
<!-- test6 				-->
<testcase>
<description>
<![CDATA[
6) Not understood URI in Req-URI but a SIP URL in To.
Server should respond 400 + Appropriate Reason Phrase  
]]>
</description>

<message>
<![CDATA[INVITE name:user SIP/2.0
To: sip:user@company.com
From: sip:caller@university.edu
Call-ID: 6@10.0.0.1
CSeq: 1 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC
]]>
</message>
<expect-exception-callback
  exception-class = "java.text.ParseException"
>

<exception-text>
<![CDATA[INVITE name:user SIP/2.0]]>
</exception-text>
</expect-exception-callback>
</testcase>
                                                 
<!-- test7 	-->
<testcase>
<description>
<![CDATA[ 
7) Legal no LWS between display name and < 
]]>
</description>

<message>
<![CDATA[OPTIONS sip:user@company.com SIP/2.0
To: sip:user@company.com
From: "caller"<sip:caller@example.com>
Call-ID: 1234abcd@10.0.0.1
CSeq: 1 OPTIONS
Via: SIP/2.0/UDP 135.180.130.133

]]>
</message>
</testcase>
<!-- test8 	-->
<testcase>
<description>
<![CDATA[ 
8) Legal extra LWS between display name and <   
]]>
</description>

<message>
<![CDATA[OPTIONS sip:user@company.com SIP/2.0
To: sip:user@company.com
From: "caller"    <sip:caller@example.com>
Call-ID: 1234abcd@10.0.0.1
CSeq: 2 OPTIONS
Via: SIP/2.0/UDP 135.180.130.133


]]>
</message>

</testcase>


<testcase>
<description>
<![CDATA[A parser must accept this as a well-formed message.  The application
using the message must treat the % HEX HEX expansions as equivalent
to the character being encoded.  The application must not try to
interpret % as an escape character in those places where % HEX HEX
("escaped" in the grammar) is not a valid part of the construction.
In [RFC3261], "escaped" only occurs in the expansions of SIP-URI,
SIPS-URI, and Reason-Phrase.
]]>
</description>

<message>
<![CDATA[INVITE sip:sips%3Auser%40example.com@example.net SIP/2.0
To: sip:%75se%72@example.com
From: <sip:I%20have%20spaces@example.net>;tag=938
Max-Forwards: 87
i: esc01.239409asdfakjkn23onasd0-3234
CSeq: 234234 INVITE
Via: SIP/2.0/UDP host5.example.net;branch=z9hG4bKkdjuw
C: application/sdp
Contact:<sip:cal%6Cer@host5.example.net;%6C%72;n%61me=v%61lue%25%34%31>

]]>
</message>

</testcase>
<!-- test9 	-->
<testcase>
<description>
<![CDATA[
9) Illegal Non GMT time zone in SIP Date
A liberal server should correct this.
]]>
</description>

<message>
<![CDATA[INVITE sip:user@company.com SIP/2.0
To: sip:user@company.com
From: sip:caller@university.edu
Call-ID: 7@10.0.0.1
CSeq: 1 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Expires: 1000
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>

</testcase>

<!-- test10 	-->

<testcase>
<description>
<![CDATA[ 
10) Legal message with passed Exipres date.
A Server should respond 408 Request Timeout.    
]]>
</description>

<message>
<![CDATA[INVITE sip:user@company.com SIP/2.0
To: sip:user@company.com
From: sip:caller@university.edu
Call-ID: 8@10.0.0.1
CSeq: 1 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Expires: 10000
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC



]]>
</message>
</testcase>

<!-- test12 	-->

<testcase>
<description>
<![CDATA[ 
12) Legal message with zero max forwards
Proxies should return 483 Too Many Hops, a UAS responds
as for OPTIONS. 
]]>
</description>

<message>
<![CDATA[INVITE sip:user@company.com SIP/2.0
To: sip:user@company.com
From: sip:caller@university.edu
Call-ID: k345asrl3fdbv@10.0.0.1
CSeq: 1 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Max-Forwards: 0
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[ 
12a) Legal message with zero max forwards
Proxies should return 483 Too Many Hops, a UAS responds
as for OPTIONS. 
]]>
</description>
<message>
<![CDATA[INVITE sip:3660@166.35.231.140 SIP/2.0
Via: SIP/2.0/UDP 166.34.120.100;branch=0000045d-00000001
Via: SIP/2.0/UDP 166.35.224.216:5060
Accept: application/sdp
Expires: 90
To: < sip:3660@166.35.231.140 >
From: <sip:4855@166.34.120.100 >;tag=1024181795
Call-ID: 1915901086@166.34.120.100
CSeq: 1 INVITE
Contact: sip:4855@166.35.224.216:5060
Content-Type: application/sdp
 
v=0
o=4855 13760767542196120 13760767542196120 IN IP4 166.35.224.216
s=nortelnetworks
p=+1 972 684 1000
c=IN IP4 166.35.224.216
t=0 0
m=audio 50012 RTP/AVP 0 8 4 18
a=rtpmap:0 PCMU/8000
a=rtpmap:8 PCMA/8000
a=rtpmap:4 G723/8000
a=rtpmap:18 G729A/8000
a=ptime:30

]]>
</message>
</testcase>

<!--			-->

<testcase>
<description>
<![CDATA[ 
11) Legal REGISTER with SIP URL containing escaped Route exception-text
in Contact
]]>
</description>

<message>
<![CDATA[REGISTER sip:company.com SIP/2.0
From: sip:user@company.com
To: sip:user@company.com
Contact: sip:user@host.company.com
Call-ID: k345asrl3fdbv@10.0.0.1
CSeq: 1 REGISTER
Via: SIP/2.0/UDP 135.180.130.133
Contact: < sip:user@example.com?Route=%3Csip:sip.example.com%3E >


]]>


</message>

</testcase>


<!-- test13 	-->

<testcase>
<description>
<![CDATA[ 
13) Legal but long, includes Token for Call-ID.    
]]>
</description>

<message>
<![CDATA[INVITE sip:user@company.com SIP/2.0
To: "I have a user name of extreme proportion"
  <sip:user@company.com:6000;other-param=1234567890somethingelselong1234567890>
From: sip:caller@university.edu
Call-ID: kl24ahsd546folnyt2vbak9sad98u23naodiunzds09a3bqw0sdfbsk34poouymnae0043nsed09mfkvc74bd0cuwnms05dknw87hjpobd76f
CSeq: 1 INVITE
My-State: sldkjflzdsfaret0803adgaasd0afds0asdaasd
Via: SIP/2.0/UDP sip33.example.com
Via: SIP/2.0/UDP sip32.example.com
Via: SIP/2.0/UDP sip31.example.com
Via: SIP/2.0/UDP sip30.example.com
Via: SIP/2.0/UDP sip29.example.com
Via: SIP/2.0/UDP sip28.example.com
Via: SIP/2.0/UDP sip27.example.com
Via: SIP/2.0/UDP sip26.example.com
Via: SIP/2.0/UDP sip25.example.com
Via: SIP/2.0/UDP sip24.example.com
Via: SIP/2.0/UDP sip23.example.com
Via: SIP/2.0/UDP sip22.example.com
Via: SIP/2.0/UDP sip21.example.com
Via: SIP/2.0/UDP sip20.example.com
Via: SIP/2.0/UDP sip19.example.com
Via: SIP/2.0/UDP sip18.example.com
Via: SIP/2.0/UDP sip17.example.com
Via: SIP/2.0/UDP sip16.example.com
Via: SIP/2.0/UDP sip15.example.com
Via: SIP/2.0/UDP sip14.example.com
Via: SIP/2.0/UDP sip13.example.com
Via: SIP/2.0/UDP sip12.example.com
Via: SIP/2.0/UDP sip11.example.com
Via: SIP/2.0/UDP sip10.example.com
Via: SIP/2.0/UDP sip9.example.com
Via: SIP/2.0/UDP sip8.example.com
Via: SIP/2.0/UDP sip7.example.com
Via: SIP/2.0/UDP sip6.example.com
Via: SIP/2.0/UDP sip5.example.com
Via: SIP/2.0/UDP sip4.example.com
Via: SIP/2.0/UDP sip3.example.com
Via: SIP/2.0/UDP sip2.example.com
Via: SIP/2.0/UDP sip1.example.com
Via: SIP/2.0/UDP host.example.com;received=135.180.130.133;branch=C1C3344E2710000000E299E568E7potato10potato0potato0
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
s=SIP Call
t=3149328700 0
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC


]]>
</message>
</testcase>
<!-- Test 14		-->
<testcase>
<description>
<![CDATA[
14) Illegal, badly mangled message with mutliple To, 
From, Call-ID and CSeq exception-texts.
Server should respond 400 + Appropriate Reason Phrase
]]>
</description>

<message>
<![CDATA[OPTIONS sip:135.180.130.133 SIP/2.0
Via: SIP/2.0/UDP company.com:5604
From: sip:iuser@company.com
To: sip:user@135.180.130.133
Call-ID: 1804928587@company.com
CSeq: 1 OPTIONS
Expires: 0 0l@company.com
To: sip:user@135.180.130.133
Call-ID: 1804928587@company.com
CSeq: 1 OPTIONS
Contact: sip:host.company.com
Expires: 0xpires: 0sip:host.company.com
Expires: 0
Contact: sip:host.company.com

]]>
</message>

<expect-exception-callback
   exception-class = "gov.nist.javax.sip.message.SIPDuplicateHeaderException"
>
<exception-text>
<![CDATA[CSeq: 1 OPTIONS]]>
</exception-text>
</expect-exception-callback>
<expect-exception-callback
   exception-class = "gov.nist.javax.sip.message.SIPDuplicateHeaderException"
>
<exception-text>
<![CDATA[Call-ID: 1804928587@company.com]]>
</exception-text>
</expect-exception-callback>

<expect-exception-callback
   exception-class = "gov.nist.javax.sip.message.SIPDuplicateHeaderException"
>
<exception-text>
<![CDATA[To: sip:user@135.180.130.133]]>
</exception-text>
</expect-exception-callback>


<expect-exception-callback
   exception-class = "java.text.ParseException"
>
<exception-text>
<![CDATA[Expires: 0xpires: 0sip:host.company.com]]>
</exception-text>
</expect-exception-callback>


<expect-exception-callback
   exception-class = "java.text.ParseException"
>
<exception-text>
<![CDATA[Expires: 0 0l@company.com]]>
</exception-text>
</expect-exception-callback>

</testcase>

<testcase>
<description>
<![CDATA[ 
15) Legal message with confusing line breaks. Note -- the orginal torture
message had an error - the contact field in an invite must only have SIP 
urls (per section 2.2 of the BIS RFC. If this is wrong, fix the checking
code in SIPRequest and SIPReply.java).
Source for tests 15 on down:
http://www.cs.columbia.edu/%7Ehgs/sip/bakeoff/
]]>
</description>

<message>
<![CDATA[INVITE sip:vivekg@chair.dnrc.bell-labs.com SIP/2.0
TO :
 sip:vivekg@chair.dnrc.bell-labs.com ;   tag    = 1a1b1f1H33n
From   : "J Rosenberg \\\"" <sip:jdrosen@lucent.com>
  ;
  tag = 98asjd8
CaLl-Id
 : 0ha0isndaksdj@10.1.1.1
cseq: 8
  INVITE
Via  : SIP  /   2.0 
 /UDP 
    135.180.130.133
Subject :
NewFangledHeader:   newfangled value
  more newfangled value
Content-Type: application/sdp
v:  SIP  / 2.0  / TCP     12.3.4.5   ;
  branch  =   9ikj8  ,
 SIP  /    2.0   / UDP  1.2.3.4   ; hidden   
m:"Quoted string \"\"" <sip:jdrosen@bell-labs.com> ; newparam = newvalue ;
  secondparam = secondvalue  ; q = 0.33
  ,
 tel:4443322

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>

</testcase>

<testcase>
<description>
<![CDATA[ 
16) Legal message with non-sip to address
]]>
</description>

<message>
<![CDATA[INVITE name:John_Smith SIP/2.0
To: sip:www.antd.nist.gov
From: sip:www.cs.columbia.edu:5060
Call-ID: 0ha0isndaksdj@10.1.2.3
CSeq: 8 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp
Contact: Joe Bob Briggs <urn:ipaddr:122.1.2.3>

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC


        
]]>
</message>
</testcase>

<!--					-->

<testcase>
<description>
<![CDATA[ 
17) This message tests support for Proxy-Require and Require. 
It is a request that contains both exception-texts, listing new features. 
Proxies and clients should respond with a 420 Bad Extension, and an 
Unsupported exception-text listing these features. 
]]>
</description>

<message>
<![CDATA[INVITE sip:user@company.com SIP/2.0
To: sip:j_user@company.com
From: sip:caller@university.edu
Call-ID: 0ha0isndaksdj@10.1.1.1
Require: newfeature1, newfeature2
Proxy-Require: newfeature3, newfeature4
CSeq: 8 INVITE
Via: SIP/2.0/UDP 135.180.130.133


]]>
</message>
</testcase>

<!--					-->


<testcase>
<description>
<![CDATA[ 
18) This message contains unknown schemes in the Request URI, 
To, From and Contact exception-texts of a request. 
A server should probably return a not found error; but
other behaviors are acceptable. 
]]>
</description>

<message>
<![CDATA[INVITE name:John_Smith SIP/2.0
To: sip:2983792873@129.6.55.181
From: sip:www.cs.columbia.edu
Call-ID: 0ha0isndaksdj@10.1.2.3
CSeq: 8 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp
Contact: Joe Bob Briggs <urn:ipaddr:122.1.2.3>

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC



]]>
</message>
</testcase>

<!--					-->


<testcase>
<description>
<![CDATA[ 
19) This message contains unknown schemes in the Request URI, 
To, From and Contact exception-texts of a request. 
A server should probably return a not found error; but
other behaviors are acceptable. 
]]>
</description>

<message>
<![CDATA[INVITE name:John_Smith SIP/2.0
To: sip:2983792873@1.2.3.4
From: sip:www.cs.columbia.edu
Call-ID: 0ha0isndaksdj@10.1.2.3
CSeq: 8 INVITE
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp
Contact: Joe Bob Briggs <urn:ipaddr:122.1.2.3>

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC



]]>
</message>
</testcase>


<testcase>
<description>
<![CDATA[
20) This message is a registration request with an expiration year 
of 2040. This makes sure that a server doesn't crash on seeing a date past 
Y2038. The correct behavior is probably to limit the lifetime to some 
configured maximum. 
]]>
</description>

<message>
<![CDATA[REGISTER sip:company.com SIP/2.0
To: sip:user@company.com
From: sip:user@company.com
Contact: sip:user@host.company.com
Call-ID: 0ha0isndaksdj@10.0.0.1
CSeq: 8 REGISTER
Via: SIP/2.0/UDP 135.180.130.133
Expires: 1000



]]>
</message>

</testcase>

<testcase>
<description>
<![CDATA[
21)This request message contains a new method, NEWMETHOD. A proxy should
forward this using the same retransmission rules as OPTIONS or BYE. A
UAS should reject it with an error, and list the available methods in
the response.
]]>
</description>

<message>
<![CDATA[NEWMETHOD sip:user@comapny.com SIP/2.0
To: sip:j.user@company.com
From: sip:caller@university.edu
Call-ID: 0ha0isndaksdj@10.0.0.1
CSeq: 8 NEWMETHOD
Via: SIP/2.0/UDP 135.180.130.133
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 126.5.4.3
c=IN IP4 135.180.130.88
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC


]]>
</message>
<expect-exception-callback
  exception-class="java.text.ParseException" 
>
<exception-text>
<![CDATA[CSeq: 8 NEWMETHOD]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[
22) Unexpected header in reply message (Subject:) 
]]>
</description>

<message>
<![CDATA[SIP/2.0 180 Ringing
CSeq: 1 INVITE
Contact: mailto:mranga@129.6.55.8
Subject: foobar
Via: SIP/2.0/UDP stinkbug.antd.nist.gov:5060
Via: SIP/2.0/UDP 129.6.55.9:7060;received=stinkbug.antd.nist.gov


]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[23) Legal Contact Header
]]>
</description>
<sip-header>
<![CDATA[Contact: "Mr. Watson" <sip:watson@worcester.bell-telephone.com>
  ;q=0.7; expires=3600,
  "Mr. Watson" <mailto:watson@bell-telephone.com> ;q=0.1 
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[23a) Legal Supported
]]>
</description>
<sip-header>
<![CDATA[Supported: 
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[24) Legal Call Info Header
]]>
</description>
<sip-header>
<![CDATA[Call-Info: <http://wwww.example.com/alice/photo.jpg> ;purpose=icon,
     <http://www.example.com/alice/> ;purpose=info
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[25) Legal Alert Info Header
]]>
</description>
<sip-header>
<![CDATA[Alert-Info: <http://wwww.example.com/sounds/moo.wav>
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[26)Legal From Header
]]>
</description>
<sip-header>
<![CDATA[From: "A. G. Bell" <sip:agb@bell-telephone.com> ;tag=a48s
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[26.1) Legal To Header
]]>
</description>
<sip-header>
<![CDATA[To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[27)Legal From Header
]]>
</description>
<sip-header>
<![CDATA[From: sip:+12125551212@server.phone2net.com
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[28)Legal From Header
]]>
</description>
<sip-header>
<![CDATA[From: Anonymous <sip:c8oqz84zk7z@privacy.org>
]]>
</sip-header>
</testcase>


<testcase>
<description>
<![CDATA[30)Legal Content Type
]]>
</description>
<sip-header>
<![CDATA[Content-Type: application/sdp
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[31)Legal Content Type
]]>
</description>
<sip-header>
<![CDATA[Content-Type: text/html; charset=ISO-8859-4
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[31.1)Legal Retry-after
]]>
</description>
<sip-header>
<![CDATA[Retry-After: 1000;duration=3600
]]>
</sip-header>
</testcase>
<testcase>
<description>
<![CDATA[31.2)Legal retry-after
]]>
</description>
<sip-header>
<![CDATA[Retry-After: 1000 (Dear John: Don't call me back, ever)
]]>
</sip-header>
</testcase>
<testcase>

<description>
<![CDATA[31.4)Legal retry-after
]]>
</description>
<sip-header>
<![CDATA[Retry-After: 120
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[32)Legal Accept 
]]>
</description>
<sip-header>
<![CDATA[Accept: application/sdp;level=1, application/x-private, text/html
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[33)Legal Accept-Language
]]>
</description>
<sip-header>
<![CDATA[Accept-Language: da, en-gb;q=0.8, en;q=0.7
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[34) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:j.doe@big.com;lr]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[35) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:j.SIP:secret@big.com;transport=tcp]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[36) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:j.doe@big.com?subject=project]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[37) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:+1-212-555-1212:1234@gateway.com;user=phone]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[37) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:1-212-555-1212:1234@gateway.com;user=phone]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[38) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:1212@gateway.com]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[39) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:alice@10.1.2.3]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[40) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:alice@example.com]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[41) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:SIP]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[42) Legal SIP URL
]]>
</description>
<sip-url>
<![CDATA[sip:alice@registrar.com;method=REGISTER]]>
</sip-url>
</testcase>

<testcase>
<description>
<![CDATA[44)Legal reply
]]>
</description>

<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Contact: LittleGuy <sip:UserB@there.com>
Content-Type: application/sdp

v=0
o=UserB 2890844527 2890844527 IN IP4 there.com
s=Session SDP
c=IN IP4 110.111.112.113
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[45)Legal ACK
]]>
</description>

<message>
<![CDATA[ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 ACK



]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[45)Legal Invite
]]>
</description>

<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com;lr>,
    <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[46) An invite with a badly formatted header (two errors)
Missing <> around the CallInfo uri and Contact address is not a valid uri
]]>
</description>

<message>
<![CDATA[INVITE sip:mranga@120.6.55.9 SIP/2.0
Via: SIP/2.0/UDP 129.6.55.9:7060
CSeq: 1 INVITE
Contact: vikram@localhost
Expires: 3600
From: sip:vikram@jitterbug.antd.nist.gov
Call-Info: http://www.nist.gov
Call-ID: 814145882@129.6.55.9
Content-Type: application/sdp
Priority: normal
Date: Sun, 07 Jan 2001 19:05:06 GMT
To: sip:mranga@120.6.55.9



]]>
</message>
<expect-exception-callback
  exception-class="java.text.ParseException" 
>
<exception-text>
<![CDATA[Contact: vikram@localhost]]>
</exception-text>
</expect-exception-callback>
<expect-exception-callback
  exception-class="java.text.ParseException" 
>
<exception-text>
<![CDATA[Call-Info: http://www.nist.gov]]>
</exception-text>
</expect-exception-callback>
</testcase>
<testcase>
<description>
<![CDATA[47)valid INVITE with record route headers
Johnston, et al.  Informational       [Page 25]
Internet Draft     SIP Telephony Call Flow Examples      November 2000
]]>
</description>

<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000


]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[48) And now, from the mangled section of the little shop of horrors -- 
unexpected header sandwiched between two truncated headers.
Missing a legal from and to header (generates SIPMissingHeaderException).
Contains a Subject header (generates invalid unexpected header exception).
]]>
</description>

<message>
<![CDATA[SIP/2.0 180 Ringing
CSeq: 1 INVITE
Contact: sip:mranga@129.6.55.8
Via: SIP/2.0/udp stinkbug.antd.nist.gov:5060
Via: SIP/2.0/UDP 129.6.55.8:7060;received=jitterbug.antd.nist.gov
From "abcdedf"
Contact: sip:mranga@129.6.55.8
"abcdefg"
Subject: foobar
]]>
</message>

<expect-exception-callback
  exception-class="java.text.ParseException" 
>
<exception-text>
<![CDATA[From "abcdedf"]]>
</exception-text>
</expect-exception-callback>

<expect-exception-callback
  exception-class="java.text.ParseException" 
>
<exception-text>
<![CDATA["abcdefg"]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[49) Legal header with a tag in the To and two via headers
]]>
</description>
<message>
<![CDATA[SIP/2.0 180 Ringing
CSeq: 1 INVITE
Contact: sip:mranga@localhost
Via: SIP/2.0/udp stinkbug.antd.nist.gov:5060
Via: SIP/2.0/UDP 129.6.55.9:7060;received=stinkbug
From: sip:vikram@jitterbug.antd.nist.gov
Call-ID: 469087875@129.6.55.9
Record-Route: <sip:mranga@129.6.55.9;maddr=129.6.55.9>
To: sip:mranga@129.6.55.9 ;tag=696928473514.129.6.55.9


]]>
</message>
</testcase>
<testcase>

<description>
<![CDATA[50) Legal header with address in via
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
CSeq: 1 INVITE
Contact: sip:mranga@localhost:6060
Via: SIP/2.0/udp 127.0.0.1:5060;branch=411ab34aab6be4c0a82649076d3b239f.127.0.0.1
Via: SIP/2.0/UDP 192.168.1.2:7060;received=stinkbug
From: sip:vikram@localhost
Content-Type: application/sdp
Call-ID: 618548932@192.168.1.2
Record-Route: <sip:mranga@localhost;maddr=127.0.0.1>
To: sip:mranga@localhost;tag=33          



]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[51)Legal Error Info
]]>
</description>
<sip-header>
<![CDATA[Error-Info:  <http://foo.bar.com/info.html> ; severity="terrible"
]]>
</sip-header>
</testcase>

<testcase>
<description>
<![CDATA[50) Legal invite
]]>
</description>
<message>
<![CDATA[INVITE sip:foo@129.6.50.27 SIP/2.0
v:SIP/2.0/UDP 129.6.50.10
i:75a4d2e6@129.6.50.10
CSeq:46728 INVITE
m:<sip:13019768226@129.6.50.10>
User-Agent:3Com ICD 1.0.1.2.7
f:3 Com SIP Phone <sip:13019768226@sipcso.3com.com>;tag=828f3abc
t:<sip:foo@129.6.50.27>
c: application/sdp
L: 97

v=0
o=username 0 46727 IN IP4 129.6.50.10
s=
c=IN IP4 129.6.50.10
t=0 0
m=audio 9000 RTP/AVP 0

]]>
</message>
</testcase>

<testcase>

<description>
<![CDATA[51) This should be rejected with 400. Section 4.1 
lists SIP version as a literal and doesn't say anything about 
ignoring leading zeros. As an example of why rejecting it is a good idea, 
consider version numbers like 2.1 and 2.01 - they are unlikely to 
refer to the same version. 
]]>
</description>
<message>
<![CDATA[INVITE sip:t.watson@ieee.org SIP/02.00
Via:     SIP/2.0/UDP c.bell-tel.com
From:    A. Bell <sip:a.g.bell@bell-tel.com>
To:      T. Watson <sip:t.watson@ieee.org>
Call-ID: 31416@c.bell-tel.com
CSeq:    1 INVITE

]]>
</message>
<expect-exception-callback
    exception-class="java.text.ParseException"
>
<exception-text>
<![CDATA[INVITE sip:t.watson@ieee.org SIP/02.00]]>
</exception-text>
</expect-exception-callback>

</testcase>
<testcase>
<description>
<![CDATA[52) Legal bye
]]>
</description>
<message>
<![CDATA[SIP/2.0 180 Ringing
Via: SIP/2.0/UDP 129.6.55.81:5060;branch=d1c2fcd388753caa0c797a9b54c2fb49.1
Record-Route: <sip:4@192.168.2.3;maddr=129.6.55.81>
Via: SIP/2.0/UDP 192.168.3.3;received=3comI
i:ca8e221e@192.168.3.3
CSeq:32820 INVITE
t:<sip:4@192.168.2.3>;tag=62e168e3
f:3ComI <sip:13019768224@192.168.3.1>;tag=c06fd3f2
Server:3Com ICD 1.0.1.2.7

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[53) Legal invite
]]>
</description>
<message>
<![CDATA[INVITE sip:+13019768227@129.6.55.81;user=phone SIP/2.0
Via: SIP/2.0/UDP  192.168.3.2:54096
From: sip:+13019768221@192.168.3.2
To: <sip:+13019768227@129.6.55.81;user=phone>
Date: Wed, 24 Mar 1993 01:02:47 GMT
Call-ID: FC2D8CD7-B1F10268-0-76ABC300@192.168.3.2
User-Agent: Cisco VoIP Gateway/ IOS 12.x/ SIP enabled
CSeq: 100 INVITE
Content-Type: application/sdp

v=0
o=CiscoSystemsSIPUserAgent 9177 8728 IN IP4 192.168.3.2
s=SIP Call
c=IN IP4 192.168.3.2
m=audio 20622 RTP/AVP 0


]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[54) Legal response
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
From: sip:rharris@172.20.12.113
To: sip:jxia@172.20.12.102;tag=901
Call-Id: 281794
Cseq: 1 INVITE
Content-Type: application/sdp
Via: SIP/2.0/UDP 172.20.12.113
Contact: sip:jxia@172.20.12.102
Allow: INVITE, ACK, CANCEL, BYE, REFER, OPTIONS, NOTIFY
User-Agent: Pingtel/0.9.1 (VxWorks)

v=0
o=Pingtel 5 5 IN IP4 172.20.12.102
s=phone-call
c=IN IP4 172.20.12.102
t=0 0
m=audio 8766 RTP/AVP 0
a=rtpmap: 0 pcmu/8000/1

]]>
</message>
</testcase>


<testcase>
<description>
<![CDATA[55) SIP Client New Registration
]]>
</description>
<message>
<![CDATA[REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Content-Length: 0

]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[56) SIP Client New Registration
]]>
</description>
<message>
<![CDATA[SIP/2.0 401 Unauthorized
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
WWW-Authenticate: Digest realm="MCI WorldCom SIP",
 domain="sip:ss2.wcom.com", nonce="ea9c8e88df84f1cec4341ae6cbe5a359",
 opaque="", stale=FALSE, algorithm=MD5
Content-Length: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[57) SIP Client New Registration
]]>
</description>
<message>
<![CDATA[REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 2 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
 nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
 uri="sip:ss2.wcom.com", response="dfe56131d1958046689cd83306477ecc"
Content-Length: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[58) SIP Client New Registration
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 2 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Content-Length: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[
59) Call-flow 1: F1 REGISTER B -> SIP Server
]]>
</description>
<message>
<![CDATA[

REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
60) Call-flow 1: F2 401 Unauthorized SIP Server -> User B
]]>
</description>
<message>
<![CDATA[SIP/2.0 401 Unauthorized
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
WWW-Authenticate: Digest realm="MCI WorldCom SIP",
 domain="sip:ss2.wcom.com", nonce="ea9c8e88df84f1cec4341ae6cbe5a359",
 opaque="", stale=FALSE, algorithm=MD5
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
61) Call-flow 1: F3 REGISTER B -> SIP Server
]]>
</description>
<message>
<![CDATA[REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 2 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
 nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
 uri="sip:ss2.wcom.com", response="dfe56131d1958046689cd83306477ecc"
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
62) Call-flow 1: F4 200 OK SIP Server -> B
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 2 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
63) Call-flow 2: F1 REGISTER B -> SIP Server
]]>
</description>
<message>
<![CDATA[REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Contact: mailto:UserB@there.com
Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
 nonce="1cec4341ae6cbe5a359ea9c8e88df84f", opaque="",
 uri="sip:ss2.wcom.com", response="71ba27c64bd01de719686aa4590d5824"
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
64) Call-flow 2: F2 200 OK SIP Server -> B
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Contact: mailto:UserB@there.com
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
65) Call-flow 3: F1 REGISTER B -> SIP Server
]]>
</description>
<message>
<![CDATA[REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
 nonce="df84f1cec4341ae6cbe5ap359a9c8e88", opaque="",
 uri="sip:ss2.wcom.com", response="aa7ab4678258377c6f7d4be6087e2f60"
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[66) Call-flow 3: F2 200 OK SIP Server -> B
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Contact: mailto:UserB@there.com
Content-Length: 0

]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
67) Call-flow 4: F1 REGISTER B -> SIP Server
]]>
</description>
<message>
<![CDATA[REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Expires: 0
Contact:*
Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
 nonce="88df84f1cac4341aea9c8ee6cbe5a359", opaque="",
 uri="sip:ss2.wcom.com", response="ff0437c51696f9a76244f0cf1dbabbea"
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
68) Call-flow 4: F2 200 OK SIP Server -> B
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
69) Call-flow 5: F1 REGISTER B -> SIP Server
]]>
</description>
<message>
<![CDATA[REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
70) Call-flow 5: F2 Unauthorized SIP Server -> User B
]]>
</description>
<message>
<![CDATA[SIP/2.0 401 Unauthorized
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 1 REGISTER
WWW-Authenticate: Digest realm="MCI WorldCom SIP",
 domain="sip:ss2.wcom.com", nonce="f1cec4341ae6ca9c8e88df84be55a359",
 opaque="", stale=FALSE, algorithm=MD5
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
71) Call-flow 5: F3 REGISTER B -> SIP Server
]]>
</description>
<message>
<![CDATA[REGISTER sip:ss2.wcom.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 2 REGISTER
Contact: LittleGuy <sip:UserB@there.com>
Contact: <sip:+1-972-555-2222@gw1.wcom.com;user=phone>
Contact: tel:+1-972-555-2222
Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
 nonce="f1cec4341ae6ca9c8e88df84be55a359", opaque="",
 uri="sip:ss2.wcom.com", response="61f8470ceb87d7ebf508220214ed438b"
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
72 Call-flow 5: F4 401 Unauthorized SIP Server -> User B
]]>
</description>
<message>
<![CDATA[SIP/2.0 401 Unauthorized
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 123456789@there.com
CSeq: 2 REGISTER
WWW-Authenticate: Digest realm="MCI WorldCom SIP",
 domain="sip:ss2.wcom.com", nonce="84f1c1ae6cbe5ua9c8e88dfa3ecm3459",
 opaque="", stale=FALSE, algorithm=MD5
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
73 Call-flow 6: F1 INVITE User A -> User B
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp
Content-Length: 141

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
74 Call-flow 6: F2 (100 Trying) User B -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
75 Call-flow 6: F3 180 Ringing User B -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 180 Ringing
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=8321234356
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
76 Call-flow 6: F4 200 OK User B -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=8321234356
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Contact: LittleGuy <sip:UserB@there.com>
Content-Type: application/sdp

v=0
o=UserB 2890844527 2890844527 IN IP4 there.com
s=Session SDP
c=IN IP4 110.111.112.113
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
77 Call-flow 6: F5 ACK User A -> User B
]]>
</description>
<message>
<![CDATA[ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=8321234356
Call-ID: 12345601@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 6: F6 BYE User B -> User A
]]>
</description>
<message>
<![CDATA[BYE sip:UserA@here.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>;tag=8321234356
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345601@here.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
78 Call-flow 6: F7 200 OK User A -> User B
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>;tag=8321234356
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345601@here.com
CSeq: 1 BYE
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
79 Call-flow 7: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
80 Call-flow 7: F2 407 Proxy Authorization Required Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 407 Proxy Authorization Required
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Proxy-Authenticate: Digest realm="MCI WorldCom SIP",
 domain="sip:ss1.wcom.com", nonce="f84f1cec41e6cbe5aea9c8e88d359",
 opaque="", stale=FALSE, algorithm=MD5
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
81 Call-flow 7: F3 ACK A -> Proxy 1
]]>
</description>
<message>
<![CDATA[ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
<expect-exception-callback
  exception-class = "java.text.ParseException"
>

<exception-text>
<![CDATA[CSeq: 1 INVITE]]>
</exception-text>
</expect-exception-callback>
</testcase>
<testcase>
<description>
<![CDATA[
82 Call-flow 7: F4 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="wf84f1ceczx41ae6cbe5aea9c8e88d359", opaque="",
 uri="sip:ss1.wcom.com", response="42ce3cef44b22f50c6a6071bc8"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 8: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 8: F2 407 Proxy Authorization Required Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 407 Proxy Authorization Required
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Proxy-Authenticate: Digest realm="WorldCom SIP",
 domain="sip:ss1.wcom.com", nonce="wf84f1cczx41ae6cbeaea9ce88d359",
 opaque="", stale=FALSE, algorithm=MD5
Content-Length: 0

]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 8: F3 ACK A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 8: F4 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="WorldCom SIP",
 nonce="wf84f1ceczx41ae6cbe5aea9c8e88d359", opaque="",
 uri="sip:ss1.wcom.com", response="42ce3cef44b22f50c6a6071bc8"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F8 CANCEL A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

CANCEL sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 CANCEL
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F9 INVITE A -> Proxy 2
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F10 407 Proxy Authorization Required Proxy 2 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 407 Proxy Authorization Required
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 INVITE
Proxy-Authenticate: Digest realm="MCI SIP",
 domain="sip:ss2.wcom.com", nonce="1ae6cbe5ea9c8e8df84fqnlec434a359",
 opaque="", stale=FALSE, algorithm=MD5
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F11 ACK A -> Proxy 2
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345601@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F12 INVITE A -> Proxy 2
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345602@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI SIP",
 nonce="1ae6cbe5ea9c8e8df84fqnlec434a359", opaque="",
 uri="sip:ss2.wcom.com", response="8a880c919d1a52f20a1593e228adf599"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F13 INVITE Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345602@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F14 (100 Trying) Proxy 2 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345602@here.com
CSeq: 1 INVITE

]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F15 180 Ringing B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345602@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F16 180 Ringing Proxy 2 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345602@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F17 200 OK B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345602@here.com
CSeq: 1 INVITE
Contact: LittleGuy <sip:UserB@there.com>
Content-Type: application/sdp

v=0
o=UserB 2890844527 2890844527 IN IP4 there.com
s=Session SDP
c=IN IP4 110.111.112.113
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F18 200 OK Proxy 2 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345602@here.com
CSeq: 1 INVITE
Contact: LittleGuy <sip:UserB@there.com>
Content-Type: application/sdp

v=0
o=UserB 2890844527 2890844527 IN IP4 there.com
s=Session SDP
c=IN IP4 110.111.112.113
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F19 ACK A -> Proxy 2
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
Route: <sip:UserB@there.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345602@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F20 ACK Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345602@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F21 BYE User B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

BYE sip:UserA@here.com SIP/2.0
Via: SIP/2.0/UDP there.com:5060
Route: <sip:UserA@here.com>
From: LittleGuy <sip:UserB@there.com>;tag=314159
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345602@here.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F22 BYE Proxy 2 -> User A
]]>
</description>
<message>
<![CDATA[

BYE sip:UserA@here.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>;tag=314159
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345602@here.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F23 200 OK User A -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>;tag=314159
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345602@here.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 9: F24 200 OK Proxy 2 -> User B
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP there.com:5060
From: LittleGuy <sip:UserB@there.com>;tag=314159
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345602@here.com
CSeq: 1 BYE
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 10: F1 INVITE A -> SIP FW
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@fwp1.wcom.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="85b4f1cen4341ae6cbe5a3a9c8e88df9", opaque="",
 uri="sip:ss1.wcom.com", response="b3f392f9218a328b9294076d708e6815"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 10: F2 INVITE SIP FW -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP fwp1.wcom.com:5060;branch=9471385739578.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=fwp1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="85b4f1cen4341ae6cbe5a3a9c8e88df9", opaque="",
 uri="sip:ss1.wcom.com", response="b3f392f9218a328b9294076d708e6815"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 200.201.202.203
t=0 0
m=audio 1000 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 10: F3 (100 Trying) SIP FW -> A
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F1 INVITE A -> Redirect Proxy
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F2 302 Moved Temporarily Redirect Proxy -> A
]]>
</description>
<message>
<![CDATA[SIP/2.0 302 Moved Temporarily
Contact: sip:UserB@everywhere.com
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[Call-flow 11: F3 ACK A -> Redirect Proxy
]]>
</description>
<message>
<![CDATA[ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[Call-flow 11: F4 INVITE A -> Proxy 2
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@everywhere.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F5 INVITE Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@everywhere.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@everywhere.com;maddr=ss2.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F6 (100 Trying) Proxy 2 -> A
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F7 (100 Trying) B -> Proxy 2
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F8 180 Ringing B -> Proxy 2
]]>
</description>
<message>
<![CDATA[SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F9 180 Ringing Proxy 2 -> A
]]>
</description>
<message>
<![CDATA[SIP/2.0 180 Ringing
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F10 200 OK B -> Proxy 2
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@everywhere.com;maddr=ss2.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: LittleGuy <sip:UserB@everywhere.com>
Content-Type: application/sdp

v=0
o=UserB 2890844527 2890844527 IN IP4 everywhere.com
s=Session SDP
c=IN IP4 111.112.113.114
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F11 200 OK Proxy -> A
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: LittleGuy <sip:UserB@everywhere.com>
Content-Type: application/sdp

v=0
o=UserB 2890844527 2890844527 IN IP4 everywhere.com
s=Session SDP
c=IN IP4 111.112.113.114
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F12 ACK A -> Proxy 2
]]>
</description>
<message>
<![CDATA[ACK sip:UserB@everyhere.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
Route: <sip:UserB@there.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 ACK
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F13 ACK Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[ACK sip:UserB@everywhere.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 ACK
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F14 BYE B -> Proxy 2
]]>
</description>
<message>
<![CDATA[BYE sip:UserA@here.com SIP/2.0
Via: SIP/2.0/UDP everywhere.com:5060
Route: <sip:UserA@here.com>
From: LittleGuy <sip:UserB@there.com>;tag=314159
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345600@here.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F15 BYE Proxy 2 -> A
]]>
</description>
<message>
<![CDATA[BYE sip:UserA@here.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP everywhere.com:5060
From: LittleGuy <sip:UserB@there.com>;tag=314159
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345600@here.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F16 200 OK A -> Proxy 2
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP everywhere.com:5060
From: LittleGuy <sip:UserB@there.com>;tag=314159
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345600@here.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 11: F17 200 OK Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP everywhere.com:5060
From: LittleGuy <sip:UserB@there.com>;tag=314159
To: BigGuy <sip:UserA@here.com>
Call-ID: 12345600@here.com
CSeq: 1 BYE
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F1 INVITE  IFT UA -> PROXY
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>
Call-ID: 1717@ift.here.com
CSeq: 17 INVITE
Contact: <sip:+1-303-555-1111@ift.here.com;user=phone>
Content-Type: application/sdp

v=0
o=IFAXTERMINAL01 2890844527 2890844527 IN IP4 ift.here.com
s=Session SDP
c=IN IP4 iftmg.here.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F2 INVITE  PROXY -> IFTGW UA
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-650-555-2222@iftgw.there.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d007.1
Via: SIP/2.0/UDP ift.here.com:5060
Record-Route: <sip:+1-650-555-2222@iftgw.there.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>
Call-ID: 1717@ift.here.com
CSeq: 17 INVITE
Contact: <sip:+1-303-555-1111@ift.here.com;user=phone>
Content-Type: application/sdp

v=0
o=IFAXTERMINAL01 2890844527 2890844527 IN IP4 ift.here.com
s=Session SDP
c=IN IP4 iftmg.here.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F3 (100 Trying) PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>
Call-ID: 1717@ift.here.com
CSeq: 17 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F4 100 Trying IFTGW UA -> PROXY
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d007.1
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: sip:+1-650-555-2222@ss1.wcom.com;user=phone
Call-ID: 1717@ift.here.com
CSeq: 17 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F5 180 Ringing IFTGW UA -> PROXY
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d007.1
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 17 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F6 180 Ringing PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 17 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F7 200 OK   IFTGW UA -> PROXY
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d007.1
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 17 INVITE
Contact: <sip:+1-650-555-2222@iftgw.there.com;user=phone>
Content-Type: application/sdp

v=0
o=IFAXTERMINAL01 2890844527 2890844527 IN IP4 iftgw.there.com
s=Session SDP
c=IN IP4 iftmg.there.com
t=0 0
m=audio 12323 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F8 200 OK   PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ift.here.com:5060
Record-Route: <sip:+1-650-555-2222@iftgw.there.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 17 INVITE
Contact: <sip:+1-650-555-2222@iftgw.there.com;user=phone>
Content-Type: application/sdp

v=0
o=IFAXTERMINAL01 2890844527 2890844527 IN IP4 iftgw.there.com
s=Session SDP
c=IN IP4 iftmg.there.com
t=0 0
m=audio 12323 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F9 ACK IFT UA -> PROXY
]]>
</description>
<message>
<![CDATA[

ACK sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ift.here.com:5060
Route: <sip:+1-650-555-2222@iftgw.there.com;maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 17 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F10 ACK PROXY -> IFTGW UA
]]>
</description>
<message>
<![CDATA[ACK sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d007.1
Via: SIP/2.0/UDP ift.here.com:5060
Record-Route: <sip:+1-650-555-2222@iftgw.there.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 17 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F11 INVITE  IFTGW UA -> PROXY
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP iftgw.there.com:5060
Route: <sip:+1-650-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 1 INVITE
Contact: <sip:+1-650-555-2222@iftgw.there.com;user=phone>
Content-Type: application/sdp

v=0
o=faxgw1 2890844527 2890844527 IN IP4 iftgw.there.com
s=Session SDP
c=IN IP4 iftmg.there.com
t=0 0
m=image 49172 udptl t38
a=T38FaxVersion:0
a=T38maxBitRate:14400
a=T38FaxFillBitRemoval:0
a=T38FaxTranscodingMMR:0
a=T38FaxTranscodingJBIG:0
a=T38FaxRateManagement:transferredTCF
a=T38FaxMaxBuffer:72
a=T38FaxMaxDatagram:316
a=T38FaxUdpEC:t38UDPRedundancy
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F12 INVITE  PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d008.1
Via: SIP/2.0/UDP iftgw.there.com:5060
Record-Route: <sip:+1-650-555-2222@ss1.wcom.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 1 INVITE
Contact: <sip:+1-650-555-2222@iftgw.there.com;user=phone>
Content-Type: application/sdp

v=0
o=faxgw1 2890844527 2890844527 IN IP4 iftgw.there.com
s=Session SDP
c=IN IP4 iftmg.there.com
t=0 0
m=image 49172 udptl t38
a=T38FaxVersion:0
a=T38maxBitRate:14400
a=T38FaxFillBitRemoval:0
a=T38FaxTranscodingMMR:0
a=T38FaxTranscodingJBIG:0
a=T38FaxRateManagement:transferredTCF
a=T38FaxMaxBuffer:72
a=T38FaxMaxDatagram:316
a=T38FaxUdpEC:t38UDPRedundancy
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F13 200 OK IFT UA -> PROXY
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d008.1
Via: SIP/2.0/UDP iftgw.there.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 1 INVITE
Contact: <sip:+1-303-555-1111@ift.here.com;user=phone>
Content-Type: application/sdp

v=0
o=faxgw1 2890846527 2890846527 IN IP4 ift.here.com
s=Session SDP
c=IN IP4 iftmg.here.com
t=0 0
m=image 15002 udptl t38
a=T38FaxVersion:0
a=T38maxBitRate:14400
a=T38FaxFillBitRemoval:0
a=T38FaxTranscodingMMR:0
a=T38FaxTranscodingJBIG:0
a=T38FaxRateManagement:transferredTCF
a=T38FaxMaxBuffer:72
a=T38FaxMaxDatagram:316
a=T38FaxUdpEC:t38UDPRedundancy
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F14 200 OK  PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP iftgw.there.com:5060
Record-Route: <sip:+1-650-555-2222@ss1.wcom.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 1 INVITE
Contact: <sip:+1-303-555-1111@ift.here.com;user=phone>
Content-Type: application/sdp

v=0
o=faxgw1 2890846527 2890846527 IN IP4 ift.here.com
s=Session SDP
c=IN IP4 iftmg.here.com
t=0 0
m=image 15002 udptl t38
a=T38FaxVersion:0
a=T38maxBitRate:14400
a=T38FaxFillBitRemoval:0
a=T38FaxTranscodingMMR:0
a=T38FaxTranscodingJBIG:0
a=T38FaxRateManagement:transferredTCF
a=T38FaxMaxBuffer:72
a=T38FaxMaxDatagram:316
a=T38FaxUdpEC:t38UDPRedundancy
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F15 ACK IFTGW UA -> PROXY
]]>
</description>
<message>
<![CDATA[ACK sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP iftgw.there.com:5060
Route: <sip:+1-650-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F16 ACK  PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[

ACK sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d008.1
Via: SIP/2.0/UDP iftgw.there.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F17 INVITE  IFTGW UA -> PROXY
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP iftgw.there.com:5060
Route: <sip:+1-650-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 2 INVITE
Contact: <sip:+1-650-555-2222@iftgw.there.com;user=phone>
Content-Type: application/sdp

v=0
o=faxgw1 2890844527 2890844527 IN IP4 iftgw.there.com
s=Session SDP
c=IN IP4 iftmg.there.com
t=0 0
m=audio 12323 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F18 INVITE  PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d009.1
Via: SIP/2.0/UDP iftgw.there.com:5060
Record-Route: <sip:+1-650-555-2222@ss1.wcom.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 2 INVITE
Contact: <sip:+1-650-555-2222@iftgw.there.com;user=phone>
Content-Type: application/sdp

v=0
o=faxgw1 2890844527 2890844527 IN IP4 iftgw.there.com
s=Session SDP
c=IN IP4 iftmg.there.com
t=0 0
m=audio 12323 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F19 200 OK IFT UA -> PROXY
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d008.1
Via: SIP/2.0/UDP iftgw.there.com:5060
Record-Route: <sip:+1-650-555-2222@ss1.wcom.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 2 INVITE
Contact: <sip:+1-303-555-1111@ift.here.com;user=phone>
Content-Type: application/sdp

v=0
o=faxgw1 2890844527 2890844527 IN IP4 ift.here.com
s=Session SDP
c=IN IP4 iftmg.here.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F20 200 OK  PROXY -> IFTGW UA
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP iftgw.there.com:5060
Record-Route: <sip:+1-650-555-2222@ss1.wcom.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 2 INVITE
Contact: <sip:+1-303-555-1111@ift.here.com;user=phone>
Content-Type: application/sdp

v=0
o=faxgw1 2890844527 2890844527 IN IP4 ift.here.com
s=Session SDP
c=IN IP4 iftmg.here.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F21 ACK IFTGW UA -> PROXY
]]>
</description>
<message>
<![CDATA[ACK sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP iftgw.there.com:5060
Route: <sip:+1-650-555-2222@ss1.wcom.com;
 maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 2 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F22 ACK  PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[ACK sip:+1-650-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d009.1
Via: SIP/2.0/UDP iftgw.there.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 2 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F23 BYE IFT UA -> PROXY
]]>
</description>
<message>
<![CDATA[BYE sip:+1-650-555-2222@ss1.wcom.com SIP/2.0
Via: SIP/2.0/UDP ift.here.com:5060
Route: <sip:+1-650-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 18 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F24 BYE PROXY -> IFTGW UA
]]>
</description>
<message>
<![CDATA[BYE sip:+1-650-555-2222@ss1.wcom.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d009.1
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 18 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F25 200 OK IFTGW UA -> PROXY
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060; branch=2d007.1
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 18 BYE
Content-Type: application/sdp
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 12: F26 200 OK  PROXY -> IFT UA
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ift.here.com:5060
From: sip:+1-303-555-1111@ift.here.com;user=phone
To: <sip:+1-650-555-2222@ss1.wcom.com;user=phone>;tag=5617
Call-ID: 1717@ift.here.com
CSeq: 18 BYE
Content-Type: application/sdp
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="ze7k1ee88df84f1cec431ae6cbe5a359", opaque="",
 uri="sip:ss1.wcom.com", response="b00b416324679d7e243f55708d44be7b"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F2 INVITE Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F3 (100 Trying) Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F4 INVITE Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com>,
 <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F5 (100 Trying) Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F6 180 Ringing B -> Proxy 2
]]>
</description>
<message>
<![CDATA[SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F7 180 Ringing Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F8 180 Ringing Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F9 CANCEL A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

CANCEL sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F10 200 OK Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[
SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F11 CANCEL Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[CANCEL sip:UserA@here.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F12 200 OK Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F13 CANCEL Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[

CANCEL sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F14 200 OK B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F15 487 Request Cancelled B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 487 Request Cancelled
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F16 ACK Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F17 487 Request Cancelled Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 487 Request Cancelled
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=9876
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F18 ACK Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=9876
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F19 487 Request Cancelled Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 487 Request Cancelled
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=4321
Call-ID: 12345600@here.com
CSeq: 1 INVITE
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 13: F20 ACK A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=4321
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F1 INVITE User A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="dc3a5ab2530aa93112cf5904ba7d88fa", opaque="",
 uri="sip:ss1.wcom.com", response="702138b27d869ac8741e10ec643d55be"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F2 INVITE Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F3 (100 Trying) Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F4 INVITE Proxy 2 -> User B
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com>,
 <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F5 (100 Trying) Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F6 486 Busy Here User B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 486 Busy Here
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F7 ACK Proxy 2 -> User B
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F8 486 Busy Here Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 486 Busy Here
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=1293
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F9 ACK Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=1293
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0

]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F10 486 Busy Here Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 486 Busy Here
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=a6b4
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 14: F11 ACK User A -> Proxy 1
]]>
</description>
<message>
<![CDATA[ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=a6b4
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F1 INVITE User A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="cf5904ba7d8dc3a5ab2530aa931128fa", opaque="",
 uri="sip:ss1.wcom.com", response="7afc04be7961f053c24f80e7dbaf888f"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F2 INVITE Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F3 (100 Trying) Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F4 INVITE Proxy 2 -> User B
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com>,
 <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F5 (100 Trying) Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F12 CANCEL Proxy 2 -> User B
]]>
</description>
<message>
<![CDATA[

CANCEL sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F13 480 No Response Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 480 No Response
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F14 ACK Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F15 480 No Response Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 480 No Response
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 15: F16 ACK User A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=159
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="aa9311cf5904ba7d8dc3a5ab253028fa", opaque="",
 uri="sip:ss1.wcom.com", response="59a46a91bf1646562a4d486c84b399db"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F2 INVITE Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F3 INVITE Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:UserB@there.com;maddr=ss2.wcom.com>,
 <sip:UserB@there.com;maddr=ss1.wcom.com>
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp
Content-Length: 141

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F4 (100 Trying) Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F5 (100 Trying) Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F6 (100 Trying) User B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F7 180 Ringing B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F8 180 Ringing Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F9 180 Ringing Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F10 480 Temporarily Unavailable B -> Proxy 2
]]>
</description>
<message>
<![CDATA[

SIP/2.0 480 Temporarily Unavailable
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F11 ACK Proxy 2 -> B
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss2.wcom.com:5060;branch=721e418c4.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F12 480 Temporarily Unavailable Proxy 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 480 Temporarily Unavailable
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=9
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F13 ACK Proxy 1 -> Proxy 2
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=9
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F14 480 Temporarily Unavailable Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 480 Temporarily Unavailable
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=489292845645245422
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 16: F15 ACK A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:UserA@here.com>
To: LittleGuy <sip:UserB@there.com>;tag=489292845645245422
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 17: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="dc3a5ab25302aa931904ba7d88fa1cf5", opaque="",
 uri="sip:ss1.wcom.com", response="ccdca50cb091d587421457305d097458c"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 17: F2 (100 Trying) Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[
SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-918-555-3333@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="qo0dc3a5ab22aa931904badfa1cf5j9h", opaque="",
 uri="sip:ss1.wcom.com", response="6c792f5c9fa360358b93c7fb826bf550"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F2 (100 Trying) Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F3 INVITE Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:444-3333@gw1.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+1-918-555-3333@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F4 (100 Trying) GW -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F8 183 Session Progress GW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 183 Session Progress
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F9 183 Session Progress Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 183 Session Progress
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F12 200 OK GW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+1-918-555-3333@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: <sip:444-3333@gw1.wcom.com;phone-context=p1234>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F13 200 OK Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+1-918-555-3333@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 INVITE
Contact: <sip:444-3333@gw1.wcom.com;phone-context=p1234>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F14 ACK A -> Proxy 1
]]>
</description>
<message>
<![CDATA[ACK sip:444-3333@ss1.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP here.com:5060
Route: <sip:444-3333@gw1.wcom.com;phone-context=p1234>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F15 ACK Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[ACK sip:444-3333@gw1.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F16 BYE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[BYE sip:444-3333@ss1.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP here.com:5060
Route: <sip:444-3333@gw1.wcom.com
 ;phone-context=p1234>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 3 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F17 BYE Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[

BYE sip:444-3333@gw1.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 3 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F18 200 OK GW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 3 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 18: F19 200 OK Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: OtherGuy <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 3 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="b59311c3ba05b401cf80b2a2c5ac51b0", opaque="",
 uri="sip:ss1.wcom.com", response="ba6ab44923fa2614b28e3e3957789ab0"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F2 INVITE Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F3 (100 Trying) Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F4 503 Service Unavailable NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 503 Service Unavailable
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=123456789
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F5 ACK Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

ACK sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=123456789
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F6 INVITE Proxy 1 -> NGW 2
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-972-555-2222@ngw2.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F9 183 Session Progress NGW 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 183 Session Progress
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F10 183 Session Progress Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 183 Session Progress
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F12 200 OK NGW 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: <sip:+1-972-555-2222@ngw2.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F13 200 OK Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: <sip:+1-972-555-2222@ngw2.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F14 ACK A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
Route: <sip:+1-972-555-2222@ngw2.wcom.com;user=phone>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F15 ACK Proxy 1 -> NGW 2
]]>
</description>
<message>
<![CDATA[

ACK sip:+1-972-555-2222@ngw2.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F16 BYE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

BYE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
Route: <sip:+1-972-555-2222@ngw2.wcom.com;user=phone>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F17 BYE Proxy 1 -> NGW 2
]]>
</description>
<message>
<![CDATA[

BYE sip:+1-972-555-2222@ngw2.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F18 200 OK NGW 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 19: F19 200 OK Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
 ;tag=314159
Call-ID: 12345600@here.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 20: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="01cf8311c3b0b2a2c5ac51bb59a05b40", opaque="",
 uri="sip:ss1.wcom.com", response="e178fbe430e6680a1690261af8831f40"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 20: F2 (100 Trying) Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 21: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+44-1234@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+44-1234@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="j1c3b0b01cf832da2c5ac51bb59a05b40", opaque="",
 uri="sip:ss1.wcom.com", response="a451358d46b55512863efe1dccaa2f42"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 21: F2 (100 Trying) Proxy 1 -> A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+44-1234@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 21: F3 INVITE Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+44-1234@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
Record-Route: <sip:+44-1234@ss1.wcom.com;maddr=ss1.wcom.com>
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+44-1234@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 21: F4 (100 Trying) NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+44-1234@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 21: F8 484 Address Incomplete NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 484 Address Incomplete
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+44-1234@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 21: F9 ACK Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

ACK sip:+44-1234@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+44-1234@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 21: F10 484 Address Incomplete Proxy 1 -> User A
]]>
</description>
<message>
<![CDATA[

SIP/2.0 484 Address Incomplete
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+44-1234@ss1.wcom.com;user=phone>;tag=141593
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 21: F11 ACK User A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:+44-1234@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+44-1234@ss1.wcom.com;user=phone>;tag=141593
Call-ID: 12345600@here.com
CSeq: 1 ACK
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 22: F1 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP here.com:5060
From: BigGuy <sip:+1-314-555-1111@ss1.wcom.com;user=phone>
To: LittleGuy <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345600@here.com
CSeq: 1 INVITE
Contact: BigGuy <sip:UserA@here.com>
Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
 nonce="da2c5ac51bb59a05j1c3b0b01cf832b40", opaque="",
 uri="sip:ss1.wcom.com", response="579cb9db184cdc25bf816f37cbc03c7d"
Content-Type: application/sdp

v=0
o=UserA 2890844526 2890844526 IN IP4 here.com
s=Session SDP
c=IN IP4 here.com
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 23: F2 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F2 INVITE NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F3 INVITE Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F4 (100 Trying) Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F5 200 OK User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: LittleGuy <sip:UserB@there.com>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 110.111.112.113
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F6 200 OK Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: LittleGuy <sip:UserB@there.com>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 110.111.112.113
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F7 ACK NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Route: <sip:UserB@there.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F8 ACK Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F12 BYE NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

BYE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Route: <sip:UserB@there.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F13 BYE Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

BYE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F14 200 OK User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 24: F15 200 OK Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 2 BYE
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F2 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@gw1.wcom.com
CSeq: 1 INVITE
Contact: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F3 INVITE Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@gw1.wcom.com
CSeq: 1 INVITE
Contact: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F4 (100 Trying) Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F5 180 Ringing User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F6 180 Ringing Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F7 200 OK User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
Contact: LittleGuy <sip:UserB@there.com>
CSeq: 1 INVITE
Content-Type: application/sdp

v=0
o=UserB 2890844527 2890844527 IN IP4 there.com
s=Session SDP
c=IN IP4 110.111.112.113
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F8 200 OK Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP gw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
CSeq: 1 INVITE
Contact: LittleGuy <sip:UserB@there.com>
Content-Type: application/sdp

v=0
o=UserB 2890844527 2890844527 IN IP4 there.com
s=Session SDP
c=IN IP4 110.111.112.113
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F9 ACK GW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP gw1.wcom.com:5060
Route: <sip:UserB@there.com>
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F10 ACK Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F11 BYE GW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

BYE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP gw1.wcom.com:5060
Route: <sip:UserB@there.com>
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F12 BYE Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

BYE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F13 200 OK User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 2 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 25: F14 200 OK Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@gw1.wcom.com
CSeq: 2 BYE
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 26: F2 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-972-555-9999@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@gw1.wcom.com;user=phone>
To: <sip:+1-972-555-9999@ss1.wcom.com;user=phone>
Call-ID: 12345602@gw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@gw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 27: F2 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 27: F3 INVITE F3 Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 27: F4 (100 Trying) Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 27: F5 600 Busy Everywhere User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 600 Busy Everywhere
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 27: F6 ACK Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 27: F7 600 Busy Everywhere Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 600 Busy Everywhere
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=59
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 27: F8 ACK NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=59
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 28: F2 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 28: F3 INVITE Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 28: F4 (100 Trying) User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 28: F5 600 Busy Everywhere User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 600 Busy Everywhere
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 28: F6 ACK Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

ACK sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 28: F7 600 Busy Everywhere Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 600 Busy Everywhere
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=66536336
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 28: F8 ACK NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

ACK sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=66536336
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 29: F2 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 29: F3 INVITE Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
c c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 29: F4 100 Trying Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 29: F12 CANCEL NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

CANCEL sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 29: F13 200 OK Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 29: F14 CANCEL Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

CANCEL sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 30: F2 INVITE NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 30: F3 INVITE Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 30: F16 CANCEL NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

CANCEL sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 30: F17 CANCEL Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

CANCEL sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F2 INVITE A -> Proxy 1
]]>
</description>
<message>
<![CDATA[

INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F3 INVITE Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
s=Session SDP
c=IN IP4 gatewayone.wcom.com
t=0 0
m=audio 3456 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F4 (100 Trying) User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100 Trying
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F5 180 Ringing User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F6 180 Ringing Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 180 Ringing
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F10 CANCEL NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

CANCEL sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F11 200 OK Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F12 CANCEL Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

CANCEL sip:UserB@there.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F13 200 OK User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 CANCEL
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F14 487 Request Cancelled User B -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 487 Request Cancelled
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F15 ACK Proxy 1 -> User B
]]>
</description>
<message>
<![CDATA[

ACK sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F16 487 Request Cancelled Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 487 Request Cancelled
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-972-555-2222@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=14159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 31: F17 ACK NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[ACK sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-972-555-2222@ss1.wcom.com;user=phone>;tag=14159
Call-ID: 12345602@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0


]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F2 INVITE NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-918-555-3333@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
Call-ID: 12345600@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GW1 2890844526 2890844526 IN IP4 gw1.wcom.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F3 INVITE Proxy 1 -> GW 2
]]>
</description>
<message>
<![CDATA[INVITE sip:444-3333@gw2.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
Record-Route: <sip:+1-918-555-3333@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>
Call-ID: 12345600@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=GW1 2890844526 2890844526 IN IP4 gw1.wcom.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F6 183 Session Progress GW 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 183 Session Progress
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F7 183 Session Progress Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 183 Session Progress
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@ngw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F10 200 OK GW 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-918-555-3333@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:444-3333@gw2.wcom.com;phone-context=p1234>
Content-Type: application/sdp

v=0
o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
s=Session SDP
c=IN IP4 100.101.102.104
t=0 0
m=audio 14918 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F11 200 OK Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Record-Route: <sip:+1-918-555-3333@ss1.wcom.com;maddr=ss1.wcom.com>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@ngw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:444-3333@gw2.wcom.com;phone-context=p1234>
Content-Type: application/sdp

v=0
o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
s=Session SDP
c=IN IP4 100.101.102.104
t=0 0
m=audio 14918 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F13 ACK NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[ACK sip:444-3333@ss1.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP ngw1.wcom.com:5060
Route: <sip:444-3333@gw2.wcom.com;phone-context=p1234>
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F14 ACK Proxy 1 -> GW 2
]]>
</description>
<message>
<![CDATA[ACK sip:444-3333@gw2.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP ngw1.wcom.com:5060
From: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
To: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
Call-ID: 12345600@ngw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F16 BYE GW 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[BYE sip:+1-314-555-1111@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP gw2.wcom.com:5060
Route: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
From: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
To: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Call-ID: 12345600@ngw1.wcom.com
CSeq: 4 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F18 BYE Proxy 1 -> NGW 1
]]>
</description>
<message>
<![CDATA[BYE sip:+1-314-555-1111@gw1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw2.wcom.com:5060
From: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
To: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Call-ID: 12345600@ngw1.wcom.com
CSeq: 4 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F19 200 OK NGW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw2.wcom.com:5060
From: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
To: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Call-ID: 12345600@ngw1.wcom.com
CSeq: 4 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 32: F20 200 OK Proxy 1 -> GW 2
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP gw2.wcom.com:5060
From: <sip:+1-918-555-3333@ss1.wcom.com;user=phone>;tag=314159
To: <sip:+1-314-555-1111@ngw1.wcom.com;user=phone>
Call-ID: 12345600@ngw1.wcom.com
CSeq: 4 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F2 INVITE GW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[INVITE sip:444-3333@ss1.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Contact: PBX_A <sip:IdentifierString@gw1.wcom.com>
Content-Type: application/sdp

v=0
o=PBX_A 2890844526 2890844526 IN IP4 gw1.wcom.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F3 INVITE Proxy 1 -> GW 2
]]>
</description>
<message>
<![CDATA[INVITE sip:444-3333@gw2.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
Record-Route: <sip:444-3333@ss1.wcom.com;maddr=ss1.wcom.com
 ;phone-context=p1234>
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Contact: PBX_A <sip:IdentifierString@gw1.wcom.com>
Content-Type: application/sdp

v=0
o=PBX_A 2890844526 2890844526 IN IP4 gw1.wcom.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F4 503 Service Unavailable GW 2 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 503 Service Unavailable
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=314159
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F5 ACK Proxy 1 -> GW 2
]]>
</description>
<message>
<![CDATA[ACK sip:444-3333@gw2.wcom.com;phone-context=p1234 SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.1
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=314159
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F6 INVITE Proxy 1 -> GW 3
]]>
</description>
<message>
<![CDATA[INVITE sip:+1-918-555-3333@gw3.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.2
Via: SIP/2.0/UDP gw1.wcom.com:5060
Record-Route: <sip:444-3333@ss1.wcom.com;maddr=ss1.wcom.com
 ;phone-context=p1234>
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Contact: PBX_A <sip:IdentifierString@gw1.wcom.com>
Content-Type: application/sdp

v=0
o=PBX_A 2890844526 2890844526 IN IP4 gw1.wcom.com
s=Session SDP
c=IN IP4 100.101.102.103
t=0 0
m=audio 49172 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F8 (100 Trying) GW 3 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 100 Trying
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F11 183 Session Progress GW 3 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 183 Session Progress
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.2
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F12 183 Session Progress Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 183 Session Progress
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F14 200 OK GW 3 -> Proxy 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.2
Via: SIP/2.0/UDP gw1.wcom.com:5060
Record-Route: <sip:444-3333@ss1.wcom.com;maddr=ss1.wcom.com
 ;phone-context=p1234>
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-918-555-3333@gw3.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
s=Session SDP
c=IN IP4 100.101.102.104
t=0 0
m=audio 14918 RTP/AVP 0
a=rtpmap:0 PCMU/8000
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F15 200 OK Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP gw1.wcom.com:5060
Record-Route: <sip:444-3333@ss1.wcom.com;maddr=ss1.wcom.com
 ;phone-context=p1234>
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 INVITE
Contact: <sip:+1-918-555-3333@gw3.wcom.com;user=phone>
Content-Type: application/sdp

v=0
o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
s=Session SDP
c=IN IP4 100.101.102.104
t=0 0
m=audio 14918 RTP/AVP 0
a=rtpmap:0 PCMU/8000

]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F16 ACK GW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[ACK sip:+1-918-555-3333@ss1.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP gw1.wcom.com:5060
Route: <sip:+1-918-555-3333@gw3.wcom.com;user=phone>
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F17 ACK Proxy 1 -> GW 3
]]>
</description>
<message>
<![CDATA[ACK sip:+1-918-555-3333@gw3.wcom.com;user=phone SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.2
Via: SIP/2.0/UDP gw1.wcom.com:5060
From: PBX_A <sip:IdentifierString@gw1.wcom.com>
To: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 ACK
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F20 BYE GW 3 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

BYE sip:IdentifierString@ss1.wcom.com SIP/2.0
Via: SIP/2.0/UDP gw3.wcom.com:5060
Route: <sip:IdentifierString@gw1.wcom.com>
From: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
To: PBX_A <sip:IdentifierString@gw1.wcom.com>
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 BYE
Content-Length: 0

]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F21 BYE Proxy 1 -> GW 1
]]>
</description>
<message>
<![CDATA[

BYE sip:IdentifierString@gw1.wcom.com SIP/2.0
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.2
Via: SIP/2.0/UDP gw3.wcom.com:5060
From: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
To: PBX_A <sip:IdentifierString@gw1.wcom.com>
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 BYE
Content-Length: 0

]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F23 200 OK GW 1 -> Proxy 1
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP ss1.wcom.com:5060;branch=2d4790.2
Via: SIP/2.0/UDP gw3.wcom.com:5060
From: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
To: PBX_A <sip:IdentifierString@gw1.wcom.com>
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>
<testcase>
<description>
<![CDATA[
Call-flow 33: F24 200 OK Proxy 1 -> GW 3
]]>
</description>
<message>
<![CDATA[SIP/2.0 200 OK
Via: SIP/2.0/UDP gw3.wcom.com:5060
From: <sip:444-3333@ss1.wcom.com;phone-context=p1234>;tag=123456789
To: PBX_A <sip:IdentifierString@gw1.wcom.com>
Call-ID: 12345600@gw1.wcom.com
CSeq: 1 BYE
Content-Length: 0
]]>
</message>
</testcase>

<!-- ************************************************************* -->
<!-- testcases exctracted from draft-ietf-sipping-torture-tests-03 -->
<!-- ************************************************************* -->

<!-- Parser tests -->

<testcase>
<description>
<![CDATA[3.1.1.1 A short tortuous INVITE
This short, relatively human-readable message contains:
o  line folding all over
o  escaped characters within quotes
o  an empty subject
o  LWS between colons, semicolons, header field values, and other
  fields
o  both comma separated and separate listing of header field values
o  mix or short and long form for the same header field name
o  unknown header fields
o  unknown header field with a value that would be syntactically
  invalid if it were defined in terms of generic-param
o  unusual header field ordering
o  unusual header field name character case
o  unknown parameters of a known header field
o  uri parameter with no value
o  header parameter with no value
o  integer fields (Max-Forwards and CSeq) with leading zeros
All elements should treat this as a well-formed request.
The UnknownHeaderWithUnusualValue header field deserves special
attention. If this header field were defined in terms of comma
separated values with semicolon separated parameters (as many of the
existing defined header fields), this would be invalid. However,
since the receiving element does not know the definition of the
syntax for this field, it must parse it as a header-value. Proxies
would forward this header field unchanged. Endpoints would ignore the
header field.
]]>
</description>
<message>
<![CDATA[

INVITE sip:vivekg@chair-dnrc.example.com;unknownparam SIP/2.0
TO :
 sip:vivekg@chair-dnrc.example.com ;   tag    = 1918181833n
from   : "J Rosenberg \\\""       <sip:jdrosen@example.com>
  ;
  tag = 98asjd8
MaX-fOrWaRdS: 0068
Call-ID: 0ha0isndaksdj@192.0.2.1
Content-Length   : 144
cseq: 0009
  INVITE
Via  : SIP  /   2.0
 /UDP
    192.0.2.2;branch=390skdjuw
s :
NewFangledHeader:   newfangled value
 continued newfangled value
UnknownHeaderWithUnusualValue: ;;,,;;,;
Content-Type: application/sdp
Route:
 <sip:services.example.com;lr;unknownwith=value;unknown-no-value>
v:  SIP  / 2.0  / TCP     spindle.example.com   ;
  branch  =   z9hG4bK9ikj8  ,
 SIP  /    2.0   / UDP  192.168.255.111   ; branch=
 z9hG4bK30239
m:"Quoted string \"\"" <sip:jdrosen@example.com> ; newparam =
      newvalue ;
  secondparam ; q = 0.33

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.3
s=-
c=IN IP4 192.0.2.4
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC
]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.2 Wide range of valid characters
This message exercises a wider range of characters in several key
syntactic elements than implementations usually see. Of particular
note:
o  The Method contains non-alpha characters from token. Note that %
  is not an escape character for this field. A method of IN%56ITE is
  an unknown method. It is not the same as a method of INVITE
o  The Request-URI contain unusual, but legal, characters
o  A branch parameter contains all non-alphanum characters from token
o  The To header field value's quoted-string contains quoted-pair
  expansions, including a quoted NULL character
o  The name part of name-addr in the From header field value contains
  multiple tokens (instead of a quoted string) with all non-alphanum
  characters from the token production rule. That value also has an
  unknown header parameter whose name contains the non-alphanum
  token characters and whose value is a non-ascii range UTF-8
  encoded string. The tag parameter on this value contains the
  non-alphanum token characters
o  The Call-ID header field value contains the non-alphanum
  characters from word. Notice that in this production:
  *  % is not an escape character. (It is only an escape character
     in productions matching the rule "escaped")
  *  " does not start a quoted-string. None of ',` or " imply that
     there will be a matching symbol later in the string
  *  The characters []{}()<> do not have any grouping semantics.
     They are not required to appear in balanced pairs
o  There is an unknown header field (matching extension-header) with
  non-alphanum token characters in its name and a UTF8-NONASCII
  value
If this unusual URI has been defined at a proxy, the proxy will
forward this request normally. Otherwise a proxy will generate a 404.
Endpoints will generate a 501 listing the methods they understand in
an Allow header field.
]]>
</description>
<message>
<![CDATA[

!interesting-Method0123456789_*+`.%indeed'~sip:1_unusual.URI~(to-be!sure)&isn't+it$/crazy?,/;;*:&it+has=1,weird!*pas$wo~d_too.(doesn't-it)@example.com SIP/2.0
Via: SIP/2.0/TCP host1.example.com;branch=z9hG4bK-.!%66*_+`'~
To: "BEL:\<hex>07</hex> NUL:\<hex>00</hex> DEL:\<hex>7F</hex>"<sip:1_unusual.URI~(to-be!sure)&isn't+it$/crazy?,/;;*@example.com>
From: token1~` token2'+_ token3*%!.- <sip:mundane@example.com>;fromParam''~+*_!.-%="<hex>D180D0B0D0B1D0BED182D0B0D18ED189D0B8D0B9</hex>";tag=_token~1'+`*%!-.
Call-ID: word%ZK-!.*_+'@word`~)(><:\/"][?}{
CSeq: 139122385 !interesting-Method0123456789_*+`.%indeed'~
Max-Forwards: 255
extensionHeader-!.%*+_`'~:<hex>EFBBBFE5A4A7E5819CE99BBB</hex>
Content-Length: 0
]]>
</message>
<expect-exception-callback
  exception-class="java.text.ParseException" 
>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.3 Valid use of the % escaping mechanism
This INVITE exercises the % HEX HEX escaping mechanism in several
places. The request is syntactically valid. Interesting features
include:
o  The request-URI has sips:user@example.com embedded in its
  userpart. What that might mean to example.net is beyond the scope
  of this document.
o  The From and To URIs have escaped characters in their userparts.
o  The Contact URI has escaped characters in the URI parameters. Note
  that the "name" uri-parameter has a value of "value%41" which is
  NOT equivalent to "valueA". Per [RFC2396], unescaping URI
  components is never performed recursively.

A parser must accept this as a well-formed message. The application
using the message must treat the % HEX HEX expansions as equivalent
to the character being encoded. The application must not try to
interpret % as an escape character in those places where % HEX HEX
("escaped" in the grammar) is not a valid part of the construction.
In [RFC3261], "escaped" only occurs in the expansions of SIP-URI,
SIPS-URI, and Reason-Phrase
]]>
</description>
<message>
<![CDATA[

INVITE sip:sips%3Auser%40example.com@example.net SIP/2.0
To: sip:%75se%72@example.com
From: <sip:I%20have%20spaces@example.net>;tag=938
Max-Forwards: 87
i: 239409asdfakjkn23onasd0-3234
CSeq: 234234 INVITE
Via: SIP/2.0/UDP host5.example.net;branch=z9hG4bKkdjuw
C: application/sdp
Contact:
  <sip:cal%6Cer@host5.example.net;%6C%72;n%61me=v%61lue%25%34%31>
Content-Length: 144

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.1
s=-
c=IN IP4 192.0.2.1
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC
]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.4 Escaped nulls in URIs
This register request contains several URIs with nulls in the
userpart. The message is well formed - parsers must accept this
message. Implementations must take special care when unescaping the
AOR in this request to not prematurely shorten the username. This
request registers two distinct contact URIs.
]]>
</description>
<message>
<![CDATA[REGISTER sip:example.com SIP/2.0
To: sip:null-%00-null@example.com
From: sip:null-%00-null@example.com;tag=839923423
Max-Forwards: 70
Call-ID: 39203ndfvkjdasfkq3w4otrq0adsfdfnavd
CSeq: 14398234 REGISTER
Via: SIP/2.0/UDP host5.example.com;branch=z9hG4bKkdjuw
Contact: <sip:%00@host5.example.com>
Contact: <sip:%00%00@host5.example.com>
L:0
]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.5 Use of % when it is not an escape
Most of the places % can appear in a SIP message, it is not an escape
character. This can surprise the unwary implementor. The following
well-formed request has these properties:
o  The request method is unknown. It is NOT equivalent to REGISTER
o  The display-name portion of the To and From header fields is
  "%Z%45". Note that this is not the same as %ZE
o  This message has two Contact header field values, not three.
  %lt;sip:alias2@host2.example.com%gt; is a C%6Fntact header field
  value
A parser should accept this message as well formed. A proxy would
forward or reject the message depending on what the Request-URI meant
to it. An endpoint would reject this message with a 501.
]]>
</description>
<message>
<![CDATA[

RE%47IST%45R sip:registrar.example.com SIP/2.0
To: "%Z%45" <sip:resource@example.com>
From: "%Z%45" <sip:resource@example.com>;tag=f232jadfj23
Call-ID: asdfnqwo34rq23i34jrjasdcnl23nrlknsdf
Via: SIP/2.0/TCP host.example.com;branch=z9hG4bK209%fzsnel234
CSeq: 29344 RE%47IST%45R
Max-Forwards: 70
Contact: <sip:alias1@host1.example.com>
C%6Fntact: <sip:alias2@host2.example.com>
Contact: <sip:alias3@host3.example.com>
l: 0
]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.6 Message with no LWS between display name and <
This OPTIONS request is not valid per the grammar in RFC 3261. since
there is no LWS between the quoted string in the display name and <
in the From header field value. This has been identified as a
specification bug that will be removed when RFC 3261 is revised.
Elements should accept this request as well formed.
]]>
</description>
<message>
<![CDATA[OPTIONS sip:user@example.com SIP/2.0
To: sip:user@example.com
From: "caller"<sip:caller@example.com>;tag=323
Max-Forwards: 70
Call-ID: 1234abcd@funky.example.com
CSeq: 60 OPTIONS
Via: SIP/2.0/UDP funky.example.com;branch=z9hG4bKkdjuw
l: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.7 Long values in header fields
This well-formed request contains header fields with many values and
values that are very long. Features include:
o  The To header field has a long display name, and long uri
  parameter names and values
o  The From header field has long header parameter names and values,
  in particular a very long tag
o  The Call-ID is one long token
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com SIP/2.0
To: "I have a user name ofextremeextremeextremeextremeextremeextremeextremeextremeextremeextreme proportion"<sip:user@example.com:6000;unknownparam1=verylonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglongvalue;longparamnamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamename=shortvalue;verylonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglongParameterNameWithNoValue>
F: sip:amazinglylongcallernameamazinglylongcallernameamazinglylongcallernameamazinglylongcallernameamazinglylongcallername@example.net;tag=12982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982982424;unknownheaderparamnamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamenamename=unknowheaderparamvaluevaluevaluevaluevaluevaluevaluevaluevaluevaluevaluevaluevaluevaluevalue;unknownValuelessparamnameparamnameparamnameparamnameparamnameparamnameparamnameparamnameparamnameparamname
Call-ID: onereallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallyreallylongcallid
CSeq: 3882340 INVITE
Unknown-LongLongLongLongLongLongLongLongLongLongLongLongLongLongLongLongLongLongLongLong-Name:unknown-longlonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglong-value;unknown-longlonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglong-parameter-name =unknown-longlonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglong-parameter-value
Via: SIP/2.0/TCP sip33.example.com
v: SIP/2.0/TCP sip32.example.com
V: SIP/2.0/TCP sip31.example.com
Via: SIP/2.0/TCP sip30.example.com
ViA: SIP/2.0/TCP sip29.example.com
VIa: SIP/2.0/TCP sip28.example.com
VIA: SIP/2.0/TCP sip27.example.com
via: SIP/2.0/TCP sip26.example.com
viA: SIP/2.0/TCP sip25.example.com
vIa: SIP/2.0/TCP sip24.example.com
vIA: SIP/2.0/TCP sip23.example.com
V :  SIP/2.0/TCP sip22.example.com
v :  SIP/2.0/TCP sip21.example.com
V  : SIP/2.0/TCP sip20.example.com
v  : SIP/2.0/TCP sip19.example.com
Via : SIP/2.0/TCP sip18.example.com
Via  : SIP/2.0/TCP sip17.example.com
Via: SIP/2.0/TCP sip16.example.com
Via: SIP/2.0/TCP sip15.example.com
Via: SIP/2.0/TCP sip14.example.com
Via: SIP/2.0/TCP sip13.example.com
Via: SIP/2.0/TCP sip12.example.com
Via: SIP/2.0/TCP sip11.example.com
Via: SIP/2.0/TCP sip10.example.com
Via: SIP/2.0/TCP sip9.example.com
Via: SIP/2.0/TCP sip8.example.com
Via: SIP/2.0/TCP sip7.example.com
Via: SIP/2.0/TCP sip6.example.com
Via: SIP/2.0/TCP sip5.example.com
Via: SIP/2.0/TCP sip4.example.com
Via: SIP/2.0/TCP sip3.example.com
Via: SIP/2.0/TCP sip2.example.com
Via: SIP/2.0/TCP sip1.example.com
Via: SIP/2.0/TCP host.example.com;received=192.0.2.5;branch=verylonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglongbranchvalue
Max-Forwards: 70
Contact: <sip:amazinglylongcallernameamazinglylongcallernameamazinglylongcallernameamazinglylongcallernameamazinglylongcallername@host5.example.net>
Content-Type: application/sdp
l: 151

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.1
s=-
c=IN IP4 192.0.2.1
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC
]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.8 Extra trailing octets in a UDP datagram
This message contains a single SIP REGISTER request, which ostensibly
arrived over UDP in a single datagram. The packet contained extra
octets after the body (which in this case has zero length). Those
octets happen to look like a SIP INVITE request, but (per section
18.3 of [RFC3261]) they are just spurious noise that must be ignored.

A SIP element receiving this datagram would handle the REGISTER
request normally and ignore the extra bits that look like an INVITE
request. If the element is a proxy choosing to forward the REGISTER,
the INVITE octets would not appear in the forwarded request.
]]>
</description>
<message>
<![CDATA[

REGISTER sip:example.com SIP/2.0
To: sip:j.user@example.com
From: sip:j.user@example.com;tag=43251j3j324
Max-Forwards: 8
I: 0ha0isndaksdj99sdfafnl3lk233412
Contact: sip:j.user@host.example.com
CSeq: 8 REGISTER
Via: SIP/2.0/UDP 192.0.2.125;branch=z9hG4bKkdjuw23492
Content-Length: 0
INVITE sip:joe@example.com SIP/2.0
t: sip:joe@example.com
From: sip:caller@example.net;tag=141334
Max-Forwards: 8
Call-ID: 0ha0isnda977644900765@192.0.2.15
CSeq: 8 INVITE
Via: SIP/2.0/UDP 192.0.2.15;branch=z9hG4bKkdjuw380234
Content-Type: application/sdp
Content-Length: 151

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.15
s=-
c=IN IP4 192.0.2.15
t=0 0
m=audio 492170 RTP/AVP 0 12
m =video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.9 Semicolon separated parameters in URI user part
This request has a semicolon-separated parameter contained in the
"user" part of the Request-URI (whose value contains an escaped @
symbol). Receiving elements will accept this as a well formed
message. The Request-URI will parse such that the user part is
"user;par=u@example.net".
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:user;par=u%40example.net@example.com SIP/2.0
To: sip:j_user@example.com
From: sip:caller@example.org;tag=33242
Max-Forwards: 3
Call-ID: 0ha0isndaksdj
CSeq: 8 OPTIONS
Accept: application/sdp, application/pkcs7-mime,
        multipart/mixed, multipart/signed,
        message/sip, message/sipfrag
Via: SIP/2.0/UDP 192.0.2.1;branch=z9hG4bKkdjuw
l: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.10 Varied and unknown transport types
This request contains Via header field values with all known
transport types and exercises the transport extension mechanism.
Parsers must accept this message as well formed. Elements receiving
this message would process it exactly as if the 2nd and subsequent
header field values specified UDP (or other transport).
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:user@example.com SIP/2.0
To: sip:user@example.com
From: <sip:caller@example.com>;tag=323
Max-Forwards: 70
Call-ID:  nfc9ehfdfaekijh4akdnaqjkwendsasfdj
Accept: application/sdp
CSeq: 60 OPTIONS
Via: SIP/2.0/UDP t1.example.com;branch=z9hG4bKkdjuw
Via: SIP/2.0/SCTP t2.example.com;branch=z9hG4bKklasjdhf
Via: SIP/2.0/TLS t3.example.com;branch=z9hG4bK2980unddj
Via: SIP/2.0/UNKNOWN t4.example.com;branch=z9hG4bKasd0f3en
Via: SIP/2.0/TCP t5.example.com;branch=z9hG4bK0a9idfnee
l: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.11 S/MIME signed message
This is a signed INVITE request. The signature is binary encoded. The
body contains null (0x00) characters. Receivers must take care to
properly frame the received message.

Parsers must accept this message as well formed, even if the
application above the parser does not support multipart/signed.
]]>
</description>
<message>
<![CDATA[

INVITE sip:receiver@example.com SIP/2.0
Via: SIP/2.0/UDP host5.example.org;branch=z9hG4bK923rnasdkl3
To: <sip:receiver@example.com>
From: <sip:sender@example.org>;tag=2390234seiu3
Call-ID: afnkjeriuoqeiuavnklafekjq34iu43uawe
CSeq: 282398492 INVITE
Max-Forwards: 70
Contact: <sip:sender@host5.example.org>
Content-Length: 3134
Content-Type: multipart/signed;
              protocol="application/pkcs-7-signature";
              micalg=sha1;
              boundary="----34CF59C076641DD0879594444157C7EB"

------34CF59C076641DD0879594444157C7EB
Content-Type: message/sip

INVITE sip:receiver@example.com SIP/2.0
Via: SIP/2.0/UDP host5.example.org;branch=z9hG4bK923rnasdkl3
To: <sip:receiver@example.com>
From: <sip:sender@example.org>;tag=2390234seiu3
Call-ID: afnkjeriuoqeiuavnklafekjq34iu43uawe
CSeq: 282398492 INVITE
Max-Forwards: 70
Contact: <sip:sender@host5.example.org>
Accept: application/sdp, application/pkcs7-mime,
        multipart/mixed, multipart/signed,
        message/sip, message/sipfrag
Content-Type: application/sdp
Content-Length: 149

v=0
o=sender 29739 7272939 IN IP4 192.0.2.1
s=-
c=IN IP4 192.0.2.1
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

------34CF59C076641DD0879594444157C7EB
Content-Type: application/pkcs-7-signature; name="smime.p7s"
Content-Transfer-Encoding: binary
Content-Disposition: attachment; filename="smime.p7s"

<hex>3082088806092A86
4886F70D010702A082087930820875020101310B300906052B0E03021A050030
0B06092A864886F70D010701A082067A30820339308202A2A003020102020800
90008902240001300D06092A864886F70D01010505003070310B300906035504
0613025553311330110603550408130A43616C69666F726E69613111300F0603
550407130853616E4A6F7365310E300C060355040A1305736970697431293027
060355040B135369706974546573744365727469666963617465417574686F72
697479301E170D3033313032313134343332355A170D31333130313831343433
32355A3062310B3009060355040613025553311330110603550408130A43616C
69666F726E69613111300F0603550407130853616E4A6F7365310E300C060355
040A13057369706974311B30190603550403141273656E646572406578616D70
6C652E6F726730819F300D06092A864886F70D010101050003818D0030818902
818100CB8302060F12C8FA2D1786922CA173DCEB80BF1B1B8AF74A310C6975A5
56A7630FB6E044D9E994DCD49AFF7976C462D7A8E74ECBF98723AEBF2796EDDD
6263577C6C2B77DC7C300B533DEDB5FB8EB3827FD6FC9B37B9A0DE829F1B1081
D632A8AD9FB00A860928E88F87E0B979BA65294AC7D6D2D18A78C86B4FA73387
4E230203010001A381E93081E6301D0603551D1104163014811273656E646572
406578616D706C652E6F726730090603551D1304023000301D0603551D0E0416
041440FF1C0C1BB8684CA917839D70E97DF8DD5B60D130819A0603551D230481
9230818F80146B461714EA94762580546E1354DAA1E35414A1B6A174A4723070
310B3009060355040613025553311330110603550408130A43616C69666F726E
69613111300F0603550407130853616E4A6F7365310E300C060355040A130573
6970697431293027060355040B13536970697454657374436572746966696361
7465417574686F72697479820100300D06092A864886F70D0101050500038181
006FFE1A3B5CE807C3DD2CFDF6E9787F491C84DBF7DCD11DB2D6A8887D2FE3F2
2E9C6894994282E50AA0DFFE1CBD4EC2C20217831FC2AD360FF1C0DE1DE1E870
102CFA99EE504C7DC0D8752A63294AC748DDDEFADE55C6D051F1CD54CFE7C153
278962A53CEF61B875C1FD3C74E972242CBA0131B3B8C607BF95B378212CA9A7
5E30820339308202A2A00302010202080090008902240001300D06092A864886
F70D01010505003070310B300906035504061302555331133011060355040813
0A43616C69666F726E69613111300F0603550407130853616E4A6F7365310E30
0C060355040A1305736970697431293027060355040B13536970697454657374
4365727469666963617465417574686F72697479301E170D3033313032313134
343332355A170D3133313031383134343332355A3062310B3009060355040613
025553311330110603550408130A43616C69666F726E69613111300F06035504
07130853616E4A6F7365310E300C060355040A13057369706974311B30190603
550403141273656E646572406578616D706C652E6F726730819F300D06092A86
4886F70D010101050003818D0030818902818100CB8302060F12C8FA2D178692
2CA173DCEB80BF1B1B8AF74A310C6975A556A7630FB6E044D9E994DCD49AFF79
76C462D7A8E74ECBF98723AEBF2796EDDD6263577C6C2B77DC7C300B533DEDB5
FB8EB3827FD6FC9B37B9A0DE829F1B1081D632A8AD9FB00A860928E88F87E0B9
79BA65294AC7D6D2D18A78C86B4FA733874E230203010001A381E93081E6301D
0603551D1104163014811273656E646572406578616D706C652E6F7267300906
03551D1304023000301D0603551D0E0416041440FF1C0C1BB8684CA917839D70
E97DF8DD5B60D130819A0603551D2304819230818F80146B461714EA94762580
546E1354DAA1E35414A1B6A174A4723070310B30090603550406130255533113
30110603550408130A43616C69666F726E69613111300F060355040713085361
6E4A6F7365310E300C060355040A1305736970697431293027060355040B1353
69706974546573744365727469666963617465417574686F7269747982010030
0D06092A864886F70D0101050500038181006FFE1A3B5CE807C3DD2CFDF6E978
7F491C84DBF7DCD11DB2D6A8887D2FE3F22E9C6894994282E50AA0DFFE1CBD4E
C2C20217831FC2AD360FF1C0DE1DE1E870102CFA99EE504C7DC0D8752A63294A
C748DDDEFADE55C6D051F1CD54CFE7C153278962A53CEF61B875C1FD3C74E972
242CBA0131B3B8C607BF95B378212CA9A75E318201D6308201D2020101307C30
70310B3009060355040613025553311330110603550408130A43616C69666F72
6E69613111300F0603550407130853616E4A6F7365310E300C060355040A1305
736970697431293027060355040B135369706974546573744365727469666963
617465417574686F7269747902080090008902240001300906052B0E03021A05
00A081B1301806092A864886F70D010903310B06092A864886F70D010701301C
06092A864886F70D010905310F170D3033313032323135323930325A30230609
2A864886F70D010904311604144A2FD5856B6006413209FA56A0C1D85179DBCB
5F305206092A864886F70D01090F31453043300A06082A864886F70D0307300E
06082A864886F70D030202020080300D06082A864886F70D0302020140300706
052B0E030207300D06082A864886F70D0302020128300D06092A864886F70D01
01010500048180C1C3193CF4A8BE1278B5529ACFA1C51DDEDECF0D3DC4C18FC5
9A5B120E6D559F4953A3C3C7C97B4EAD8388F1508F7AD2FC71CC7B9ED2844789
60A3ECF87984E25A15B4AB63F150C30570B6315A2327E381EE11E866DC1405DA
29E74CC20201816F1516DD893332D9A8E26FBAEC237C494F3EFAEF4EBCD2122C
DE7D57DECD</hex>------34CF59C076641DD0879594444157C7EB--

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.12 Unusual reason phrase
This 200 response contains a reason phrase other than "OK". The
reason phrase is intended for human consumption, and may contain any
string produced by

   Reason-Phrase   =  *(reserved / unreserved / escaped
                      / UTF8-NONASCII / UTF8-CONT / SP / HTAB)

This particular response contains unreserved and non-ASCII UTF-8
characters.This response is well formed. A parser must accept this
message.
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 = 2**3 * 5**2 <hex>D0BDD0BE20D181D182D0BE20D0B4D0B5D0B2D18FD0BDD0BED181D182D0BE20D0B4D0B5D0B2D18FD182D18C202D20D0BFD180D0BED181D182D0BED0B5</hex>
Via: SIP/2.0/UDP 192.0.2.198;branch=z9hG4bK1324923
Call-ID: 0384840201234ksdfak3j2erwedfsASdf
CSeq: 35 INVITE
From: sip:user@example.com;tag=11141343
To: sip:user@example.edu;tag=2229
Content-Length: 159
Content-Type: application/sdp
Contact: <sip:user@host198.example.com>

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.198
s=-
c=IN IP4 192.0.2.198/127
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.1.13 Empty reason phrase
This well formed response contains no reason phrase. A parser must
accept this message. The space character after the reason code is
required. If it were not present, this message could be rejected as
invalid (a liberal receiver would accept it anyway).
]]>
</description>
<message>
<![CDATA[

SIP/2.0 100<hex>20</hex>
Via: SIP/2.0/UDP 192.0.2.105;branch=z9hG4bK2398ndaoe
Call-ID: adsn2309jasndj203insdf99223ndf
CSeq: 35 INVITE
From: <sip:user@example.com>;tag=39ansfi3
To: <sip:user@example.edu>;tag=902jndnke3
Content-Length: 0
Contact: <sip:user@host105.example.com>

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.1 Extraneous header field separators
The Via and header field of this request contains contain additional
semicolons and commas without parameters or values. The Contact
header field contains additional semicolons without parameters. This
message is syntactically invalid.

An element receiving this request should respond with a 400 Bad
Request error.
]]>
</description>
<message>
<![CDATA[INVITE sip:user@example.com SIP/2.0
To: sip:j.user@example.com
From: sip:caller@example.net;tag=134161461246
Max-Forwards: 7
Call-ID: 0ha0isndaksdjasdf3234nas
CSeq: 8 INVITE
Via: SIP/2.0/UDP 192.0.2.15;;,;,,
Contact: "Joe" <sip:joe@example.org>;;;;
Content-Length: 153
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.15
s=-
c=IN IP4 192.0.2.15
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.2 Content length larger than message
This is a request message with a Content Length that is larger than
the length of the body.

When sent UDP (as this message ostensibly was), the receiving element
should respond with a 400 Bad Request error. If this message were
received over a stream-based transport such as TCP, there's not much
you can do but wait for more data on the stream and close the
connection if none is forthcoming in a reasonable period of time.
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com SIP/2.0
Max-Forwards: 80
To: sip:j.user@example.com
From: sip:caller@example.net;tag=93942939o2
Contact: <sip:caller@hungry.example.net>
Call-ID: 0ha0isndaksdjweiafasdk3
CSeq: 8 INVITE
Via: SIP/2.0/UDP host5.example.com;branch=z9hG4bK-39234-23523
Content-Type: application/sdp
Content-Length: 9999

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.155
s=-
c=IN IP4 192.0.2.155
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[Content-Length: 9999]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.3 Negative Content-Length
This request has a negative value for Content-Length.

An element receiving this message should respond with an error. This
request appeared over UDP, so the remainder of the datagram can
simply be discarded. If a request like this arrives over TCP, the
framing error is not recoverable and the connection should be closed.
The same behavior is appropriate for messages that arrive without a
numeric value in the Content-Length header field such as:

   Content-Length: five

Implementors should take extra precautions if the technique they
choose for converting this ascii field into an integral form can
return a negative value. In particular, the result must not be used
as a counter or array index.
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com SIP/2.0
Max-Forwards: 254
To: sip:j.user@example.com
From: sip:caller@example.net;tag=32394234
Call-ID: 0ha0isndaksdj2193423r542w35
CSeq: 0 INVITE
Via: SIP/2.0/UDP 192.0.2.53;branch=z9hG4bKkdjuw
Contact: <sip:caller@example53.example.net>
Content-Type: application/sdp
Content-Length: -999

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.53
s=-
c=IN IP4 192.0.2.53
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[Content-Length: -999]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.4 Request scalar fields with overlarge values
This request contains several scalar header field values outside
their legal range.
o  the CSeq sequence number is >2**32-1.
o  the Max-Forwards value is >255.
o  the Expires value is >2**32-1.
o  the Contact expires parameter value is >2**32-1.
An element receiving this request should respond with a 400 Bad
Request due to the CSeq error. If only the Max-Forwards field were in
error, the element could choose process the request as if the field
were absent. If only the expiry values were in error, the element
could treat them as if they contained the default values for
expiration (3600 in this case).
Other scalar request fields that may contain aberrant values include,
but are not limited to,  the Contact q value, the Timestamp value,
and the Via ttl parameter.
]]>
</description>
<message>
<![CDATA[

REGISTER sip:example.com SIP/2.0
Via: SIP/2.0/TCP host129.example.com;branch=z9hG4bK342sdfoi3
To: <sip:user@example.com>
From: <sip:user@example.com>;tag=239232jh3
CSeq: 36893488147419103232 REGISTER
Call-ID: asdnw3qjr23o0pd9vanlq3wnrlnewofjas9ui32
Max-Forwards: 300
Expires: 1<repeat count=100>0</repeat>
Contact: <sip:user@host129.example.com>
  ;expires=280297596632815
Content-Length: 0

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.5 Response scalar fields with overlarge values
This response contains several scalar header field values outside
their legal range.
o  the CSeq sequence number is >2**32-1.
o  The Retry-After field is unreasonably large (note that RFC 3261
  does not define a legal range for this field).
o  The Warning field has a warning-value with more than 3 digits
An element receiving this response will simply discard it.
]]>
</description>
<message>
<![CDATA[

SIP/2.0 503 Service Unavailable
Via: SIP/2.0/TCP host129.example.com;branch=z0hG4bKzzxdiwo34sw
To: <sip:user@example.com>
From: <sip:other@example.net>;tag=2easdjfejw
CSeq: 9292394834772304023312 OPTIONS
Call-ID: nvoao34irnoase0of0234hn2qofoaf0232aewf2394r
Retry-After: 949302838503028349304023988
Warning: 1812 overture "In Progress"
Content-Length: 0

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.6 Unterminated quoted string in display-name
This is a request with an unterminated quote in the display name of
the To field. An element receiving this request should return an 400
Bad Request error.
An element could attempt to infer a terminating quote and accept the
message. Such an element needs to take care that it makes a
reasonable inference when it encounters
  To: "Mr J. User <sip:j.user@example.com> <sip:realj@example.net>
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com SIP/2.0
To: "Mr. J. User <sip:j.user@example.com>
From: sip:caller@example.net;tag=93334
Max-Forwards: 10
Call-ID: 0ha0isndaksdj
Contact: <sip:caller@host59.example.net>
CSeq: 8 INVITE
Via: SIP/2.0/UDP 192.0.2.59:5050;branch=z9hG4bKkdjuw39234
Content-Type: application/sdp
Content-Length: 153

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.15
s=-
c=IN IP4 192.0.2.15
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[To: "Mr. J. User <sip:j.user@example.com>]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.7 <> enclosing Request-URI
This INVITE request is invalid because the Request-URI has been
enclosed within in "<>".

It is reasonable to always reject a request with this error with a
400 Bad Request. Elements attempting to be liberal with what they
accept may choose to ignore the brackets. If the element forwards the
request, it must not include the brackets in the messages it sends.
]]>
</description>
<message>
<![CDATA[

INVITE <sip:user@example.com> SIP/2.0
To: sip:user@example.com
From: sip:caller@example.net;tag=39291
Max-Forwards: 23
Call-ID: 1@192.0.2.5
CSeq: 1 INVITE
Via: SIP/2.0/UDP 192.0.2.5
Contact: <sip:caller@host5.example.net>
Content-Type: application/sdp
Content-Length: 160

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.5
s=-
c=IN IP4 192.0.2.5
t=3149328700 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[INVITE <sip:user@example.com> SIP/2.0]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.8 Malformed SIP Request-URI (embedded LWS)
This INVITE has illegal LWS within the Request-URI.
An element receiving this request should respond with a 400 Bad
Request.
An element could attempt to ignore the embedded LWS for those schemes
(like sip) where that would not introduce ambiguity.
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com; lr SIP/2.0
To: sip:user@example.com;tag=3xfe-9921883-z9f
From: sip:caller@example.net;tag=231413434
Max-Forwards: 5
Call-ID: asdfasdoijweoi2323-asdfwern23-asd8ia0swn34rk423
CSeq: 2130706432 INVITE
Via: SIP/2.0/UDP 192.0.2.1:5060;branch=z9hG4bKkdjuw2395
Contact: <sip:caller@host1.example.net>
Content-Type: application/sdp
Content-Length: 160

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.1
s=-
c=IN IP4 192.0.2.1
t=3149328700 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[INVITE sip:user@example.com; lr SIP/2.0]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.9 Multiple SP separating Request-Line elements
This INVITE has illegal multiple SP characters between elements of
the start line.
It is acceptable to reject this request as malformed. An element that
is liberal in what it accepts may ignore these extra SP characters
while processing the request. If the element forwards the request, it
must not include these extra SP characters in the messages it sends.
]]>
</description>
<message>
<![CDATA[

INVITE  sip:user@example.com  SIP/2.0
Max-Forwards: 8
To: sip:user@example.com
From: sip:caller@example.net;tag=8814
Call-ID: 2304u0qwsdfknq234oi243099adsdfnawe3@example.com
CSeq: 1893884 INVITE
Via: SIP/2.0/UDP host1.example.com;branch=z9hG4bKkdjuw3923
Contact: <sip:caller@host1.example.net>
Content-Type: application/sdp
Content-Length: 151

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.1
s=-
c=IN IP4 192.0.2.1
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC
]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[INVITE  sip:user@example.com  SIP/2.0]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.10 SP characters at end of Request-Line
This OPTIONS request contains SP characters between the SIP-Version
field and the CRLF terminating the Request-Line.

It is acceptable to reject this request as malformed. An element that
is liberal in what it accepts may ignore these extra SP characters
while processing the request. If the element forwards the request, it
must not include these extra SP characters in the messages it sends.
]]>
</description>
<message>
<![CDATA[OPTIONS sip:remote-target@example.com SIP/2.0<hex>2020</hex>
Via: SIP/2.0/TCP host1.examle.com;branch=z9hG4bK299342093
To: <sip:remote-target@example.com>
From: <sip:local-resource@example.com>;tag=329429089
Call-ID: afewroicu34958239neffasdhr2345r
Accept: application/sdp
CSeq: 238923 OPTIONS
Max-Forwards: 70
Content-Length: 0

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[OPTIONS sip:remote-target@example.com SIP/2.0<hex>2020</hex>]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.11 Escaped headers in SIP Request-URI
This INVITE is malformed as the SIP Request-URI contains escaped
headers.
It is acceptable for an element to reject this request with a 400 Bad
Request. An element could choose to be liberal in what it accepts and
ignore the escaped headers. If the element is a proxy, the escaped
headers must not appear in the Request-URI of forwarded request (and
most certainly must not be translated into the actual header of the
forwarded request).
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com?Route=%3Csip:example.com%3E SIP/2.0
To: sip:user@example.com
From: sip:caller@example.net;tag=341518
Max-Forwards: 7
Contact: <sip:caller@host39923.example.net>
Call-ID: 23940-asdfhj-aje3br-234q098w-fawerh2q-h4n5
CSeq: 149209342 INVITE
Via: SIP/2.0/UDP host-of-the-hour.example.com;branch=z9hG4bKkdjuw
Content-Type: application/sdp
Content-Length: 151

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.1
s=-
c=IN IP4 192.0.2.1
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[INVITE sip:user@example.com?Route=%3Csip:example.com%3E SIP/2.0]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.12 Invalid timezone in Date header field
This INVITE is invalid as it contains a non GMT time zone in the SIP
Date header field.
It is acceptable to reject this request as malformed (though an
element shouldn't do that unless the contents of the Date header
field were actually important to its processing).  An element wishing
to be liberal in what it accepts could ignore this value altogether
if it wasn't going to use the Date header field anyhow. Otherwise, it
could attempt to interpret this date and adjust it to GMT.
RFC 3261 explicitly defines the only acceptable timezone designation
as "GMT". "UT", while synonymous with GMT per [RFC2822], is not
valid. "UTC" and "UCT" are also invalid.
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com SIP/2.0
To: sip:user@example.com
From: sip:caller@example.net;tag=2234923
Max-Forwards: 70
Call-ID: 239423mnsadf3j23lj42--sedfnm234
CSeq: 1392934 INVITE
Via: SIP/2.0/UDP host.example.com;branch=z9hG4bKkdjuw
Date: Fri, 01 Jan 2010 16:00:00 EST
Contact: <sip:caller@host5.example.net>
Content-Type: application/sdp
Content-Length: 151

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.5
s=-
c=IN IP4 192.0.2.5
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[Date: Fri, 01 Jan 2010 16:00:00 EST]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.13 Failure to enclose name-addr URI in <>
This REGISTER request is malformed. The SIP URI contained in the
Contact Header field has an escaped header, so the field must be in
name-addr form (which implies the URI must be enclosed in <>).
It is reasonable for an element receiving this request to respond
with a 400 Bad Request. An element choosing to be liberal in what it
accepts could infer the angle brackets since there is no ambiguity in
this example. In general, that won't be possible.
]]>
</description>
<message>
<![CDATA[

REGISTER sip:example.com SIP/2.0
To: sip:user@example.com
From: sip:user@example.com;tag=998332
Max-Forwards: 70
Call-ID: k345asrl3fdbv@10.0.0.1
CSeq: 1 REGISTER
Via: SIP/2.0/UDP 135.180.130.133:5060;branch=z9hG4bKkdjuw
Contact: sip:user@example.com?Route=%3Csip:sip.example.com%3E
l: 0

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[Contact: sip:user@example.com?Route=%3Csip:sip.example.com%3E]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.14 Spaces within addr-spec
This request is malformed since the addr-spec in the To header field
contains spaces. Parsers receiving this request must not break. It is
reasonable to reject this request with a 400 Bad Request response.
Elements attempting to be liberal may ignore the spaces.
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:user@example.org SIP/2.0
Via: SIP/2.0/UDP host4.example.com:5060;branch=z9hG4bKkdju43234
Max-Forwards: 70
From: "Bell, Alexander" <sip:a.g.bell@example.com>;tag=433423
To: "Watson, Thomas" < sip:t.watson@example.org >
Call-ID: sdf0234n2nds0a099u23h3hnnw009cdkne3
Accept: application/sdp
CSeq: 3923239 OPTIONS
l: 0

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[To: "Watson, Thomas" < sip:t.watson@example.org >]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.15 Non-token characters in display-name
This OPTIONS request is malformed since  the display names in the To
and From header fields contain non-token characters but are unquoted.
It is reasonable to always reject this kind of error with a 400 Bad
Request response.
An element may attempt to be liberal in what it receives and infer
the missing quotes. If this element were a proxy, it must not
propagate the error into the request it forwards. As a consequence,
if the fields are covered by a signature, there's not much point in
trying to be liberal - the message should be simply rejected.
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:t.watson@example.org SIP/2.0
Via:     SIP/2.0/UDP c.example.com:5060;branch=z9hG4bKkdjuw
Max-Forwards:      70
From:    Bell, Alexander <sip:a.g.bell@example.com>;tag=43
To:      Watson, Thomas <sip:t.watson@example.org>
Call-ID: 31415@c.example.com
Accept: application/sdp
CSeq:    3923239 OPTIONS
l: 0

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[From:    Bell, Alexander <sip:a.g.bell@example.com>;tag=43]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.16 Unknown protocol version
To an element implementing [RFC3261], this request is malformed due
to its high version number.

The element should respond to the request with a 505 Version Not
Supported error.
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:t.watson@example.org SIP/7.0
Via:     SIP/7.0/UDP c.example.com;branch=z9hG4bKkdjuw
Max-Forwards:     70
From:    A. Bell <sip:a.g.bell@example.com>;tag=qweoiqpe
To:      T. Watson <sip:t.watson@example.org>
Call-ID: 31417@c.example.com
CSeq:    1 OPTIONS
l: 0

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[OPTIONS sip:t.watson@example.org SIP/7.0]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.17 Start line and CSeq method mismatch
This request has mismatching values for the method in the start line
and the CSeq header field. Any element receiving this request will
respond with a 400 Bad Request.
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:user@example.com SIP/2.0
To: sip:j.user@example.com
From: sip:caller@example.net;tag=34525
Max-Forwards: 6
Call-ID: 0ha0isndaksdj0234sxdfl3
CSeq: 8 INVITE
Via: SIP/2.0/UDP host.example.com;branch=z9hG4bKkdjuw
l: 0

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[CSeq: 8 INVITE]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.18 Unknown Method with CSeq method mismatch
This message has an unknown method, and a CSeq method tag which does
not match it.

Any element receiving this response will should respond with a 501
Not Implemented. A 400 Bad Request is also acceptable, but choosing a
501 (particularly at proxies) has better future-proof
characteristics.
]]>
</description>
<message>
<![CDATA[

NEWMETHOD sip:user@example.com SIP/2.0
To: sip:j.user@example.com
From: sip:caller@example.net;tag=34525
Max-Forwards: 6
Call-ID: 0ha0isndaksdj0234sxdfl3
CSeq: 8 INVITE
Contact: <sip:caller@host.example.net>
Via: SIP/2.0/UDP host.example.net;branch=z9hG4bKkdjuw
Content-Type: application/sdp
l: 139

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.1
c=IN IP4 192.0.2.1
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[CSeq: 8 INVITE]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.1.2.19 Overlarge response code
This response has a response code larger than 699. An element
receiving this response should simply drop it.
]]>
</description>
<message>
<![CDATA[

SIP/2.0 4294967301 better not break the receiver
Via: SIP/2.0/UDP 192.0.2.105;branch=z9hG4bK2398ndaoe
Call-ID: asdof3uj203asdnf3429uasdhfas3ehjasdfas9i
CSeq: 353494 INVITE
From: <sip:user@example.com>;tag=39ansfi3
To: <sip:user@example.edu>;tag=902jndnke3
Content-Length: 0
Contact: <sip:user@host105.example.com>

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[SIP/2.0 4294967301 better not break the receiver]]>
</exception-text>
</expect-exception-callback>
</testcase>

<!-- transaction layer semantics -->

<testcase>
<description>
<![CDATA[3.2.1 Missing transaction identifier
This request indicates support for RFC 3261-style transaction
identifiers by providing the z9hG4bK prefix to the branch parameter,
but it provides no identifier. A parser must not break when receiving
this message. An element receiving this request could reject the
request with a 400 Response (preferably statelessly, as other
requests from the source are likely to also have a malformed branch
parameter), or it could fall back to the RFC 2543 style transaction
identifier.
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:user@example.com SIP/2.0
To: sip:user@example.com
From: sip:caller@example.org;tag=33242
Max-Forwards: 3
Via: SIP/2.0/UDP 192.0.2.1;branch=z9hG4bK
Accept: application/sdp
Call-ID: sadonfo23i420jv0as0derf3j3n
CSeq: 8 OPTIONS
l: 0

]]>
</message>
</testcase>

<!-- application layer semantics -->

<testcase>
<description>
<![CDATA[3.3.1 Missing Required Header Fields
This request contains no Call-ID, From, or To header fields.
An element receiving this message must not break because of the
missing information. Ideally, it will respond with a 400 Bad Request
error.
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com SIP/2.0
CSeq: 193942 INVITE
Via: SIP/2.0/UDP 192.0.2.95;branch=z9hG4bKkdjuw
Content-Type: application/sdp
l: 153

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.95
s=-
c=IN IP4 192.0.2.95
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[headers missing???]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.3.2 Request-URI with unknown scheme
This OPTIONS contains an unknown URI scheme in the Request-URI. A
parser must accept this as a well-formed SIP request.
An element receiving this request will reject it with a 416
Unsupported URI Scheme response.
Some early implementations attempt to look at the contents of the To
header field to determine how to route this kind of request. That is
an error. Despite the fact that the To header field and the Request
URI frequently look alike in simplistic first-hop messages, the To
header field contains no routing information.
]]>
</description>
<message>
<![CDATA[

OPTIONS nobodyKnowsThisScheme:totallyopaquecontent SIP/2.0
To: sip:user@example.com
From: sip:caller@example.net;tag=384
Max-Forwards: 3
Call-ID: 2340923nasdfasser0q239nwsdfasdkl34
CSeq: 3923423 OPTIONS
Via: SIP/2.0/TCP host9.example.com;branch=z9hG4bKkdjuw39234
Content-Length: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.3 Request-URI with known but atypical scheme
This OPTIONS contains an Request-URI with an IANA registered scheme
that does not commonly appear Request-URIs of SIP requests. A parser
must accept this as a well-formed SIP request.
If an element will never accept this scheme as meaningful in a
request-URI, it is appropriate to treat it as unknown and return a
416 Unsupported URI Scheme response. If the element might accept some
URIs with this scheme, then a 404 Not Found is appropriate for those
URIs it doesn't accept.
]]>
</description>
<message>
<![CDATA[

OPTIONS soap.beep://192.0.2.103:3002 SIP/2.0
To: sip:user@example.com
From: sip:caller@example.net;tag=384
Max-Forwards: 3
Call-ID: 2340923nasdfasser0q239nwsdfasdkl34
CSeq: 3923423 OPTIONS
Via: SIP/2.0/TCP host9.example.com;branch=z9hG4bKkdjuw39234
Content-Length: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.4 Unknown URI schemes in header fields
This message contains registered schemes in the To, From and Contact
header fields of a request. The message is syntactically valid.
Parsers must not fail when receiving this message.
Proxies should treat this message as they would any other request for
this URI. A registrar would reject this request with a 400 Bad
Request response since the To: header field is required to contain a
SIP or SIPS URI as an AOR.
]]>
</description>
<message>
<![CDATA[

REGISTER sip:example.com SIP/2.0
To: isbn:2983792873
From: <http://www.example.com>;tag=3234233
Call-ID: 0ha0isndaksdj@hyphenated-host.example.com
CSeq: 234902 REGISTER
Max-Forwards: 70
Via: SIP/2.0/UDP 192.0.2.21:5060;branch=z9hG4bKkdjuw
Contact: <name:John_Smith>
l: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.5 Proxy-Require and Require
This request tests proper implementation of SIP's Proxy-Require and
Require extension mechanisms.
Any element receiving this request will respond with a 420 Bad
Extension response containing an Unsupported header field listing
these features from either the Require or Proxy-Require header field
depending on the role in which the element is responding.
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:user@example.com SIP/2.0
To: sip:j_user@example.com
From: sip:caller@example.net;tag=242etr
Max-Forwards: 6
Call-ID: 0ha0isndaksdj
Require: nothingSupportsThis, nothingSupportsThisEither
Proxy-Require: noProxiesSupportThis, norDoAnyProxiesSupportThis
CSeq: 8 OPTIONS
Via: SIP/2.0/TLS fold-and-staple.example.com;branch=z9hG4bKkdjuw
Content-Length: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.6 Unknown Content-Type
This INVITE request contains a body of unknown type. It is
syntactically valid. A parser must not fail when receiving it.
A proxy receiving this request would process it just like any other
INVITE. An endpoint receiving this request would reject it with a 415
Unsupported Media Type error.
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com SIP/2.0
Contact: <sip:caller@host5.example.net>
To: sip:j.user@example.com
From: sip:caller@example.net;tag=8392034
Max-Forwards: 70
Call-ID: 0ha0isndaksdjadsfij34n23d
CSeq: 235448 INVITE
Via: SIP/2.0/UDP somehost.example.com;branch=z9hG4bKkdjuw
Content-Type: application/unknownformat
Content-Length: 40

<audio>
 <pcmu port="443"/>
</audio>

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.7 Unknown authorization scheme
This REGISTER request contains an Authorization header field with an
unknown scheme. The request is well-formed. A parser must not fail
when receiving it.
A proxy will treat this request as any other REGISTER. If it forwards
the request, it will include this Authorization header field
unmodified in the forwarded messages.
A registrar that does not care about challenge-response
authentication will simply ignore the Authorization header field,
processing this registration as if the field were not present. A
registrar that does care about challenge-response authentication will
reject this request with a 401, issuing a new challenge with a scheme
it understands.
Endpoints choosing not to act as registrars will simply reject the
request. A 405 Method Not Allowed is appropriate.
]]>
</description>
<message>
<![CDATA[

REGISTER sip:example.com SIP/2.0
To: sip:j.user@example.com
From: sip:j.user@example.com;tag=87321hj23128
Max-Forwards: 8
Call-ID: 0ha0isndaksdj
CSeq: 9338 REGISTER
Via: SIP/2.0/TCP 192.0.2.253;branch=z9hG4bKkdjuw
Authorization: NoOneKnowsThisScheme opaque-data=here
Content-Length:0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.8 Multiple values in single value required fields
The message contains a request with multiple Call-ID, To, From,
Max-Forwards and CSeq values. An element receiving this request must
not break.
An element receiving this request would respond with a 400 Bad
Request error.
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@company.com SIP/2.0
Contact: <sip:caller@host25.example.net>
Via: SIP/2.0/UDP 192.0.2.25;branch=z9hG4bKkdjuw
Max-Forwards: 70
CSeq: 5 INVITE
Call-ID: 98asdh@192.0.2.1
CSeq: 59 INVITE
Call-ID: 98asdh@192.0.2.2
From: sip:caller@example.com;tag=3413415
To: sip:user@example.com
To: sip:other@example.net
From: sip:caller@example.net;tag=2923420123
Content-Type: application/sdp
l: 155
Contact: <sip:caller@host36.example.net>
Max-Forwards: 5

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.25
s=-
c=IN IP4 192.0.2.25
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.9 Multiple Content-Length values
Multiple conflicting Content-Length header field values appear in
this request.
From a framing perspective, this situation is equivalent to an
invalid Content-Length value (or no value at all).
An element receiving this message should respond with an error. This
request appeared over UDP, so the remainder of the datagram can
simply be discarded. If a request like this arrives over TCP, the
framing error is not recoverable and the connection should be closed.
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:user@example.com SIP/2.0
Via: SIP/2.0/UDP host5.example.net;branch=z9hG4bK293423
To: sip:user@example.com
From: sip:other@example.net;tag=3923942
Call-ID: 234asdfhn2323orihawfdoa3o4r52o3irsdf
CSeq: 15932 OPTIONS
Content-Length: 13
Max-Forwards: 60
Content-Length: 5
Content-Type: text/plain

There's no way to know how many octets are supposed to be here.

]]>
</message>
<expect-exception-callback exception-class = "java.text.ParseException">
<exception-text>
<![CDATA[Content-Length: 5]]>
</exception-text>
</expect-exception-callback>
</testcase>

<testcase>
<description>
<![CDATA[3.3.10 200 OK Response with broadcast Via header field value
This message is a response with a 2nd Via header field value's
sent-by containing 255.255.255.255. The message is well formed -
parsers must not fail when receiving it.
Per [RFC3261] an endpoint receiving this message should simply
discard it.
If a proxy followed normal response processing rules blindly, it
would forward this response to the broadcast address. To protect
against this being used as an avenue of attack, proxies should drop
such responses.
]]>
</description>
<message>
<![CDATA[

SIP/2.0 200 OK
Via: SIP/2.0/UDP 192.0.2.198;branch=z9hG4bK1324923
Via: SIP/2.0/UDP 255.255.255.255;branch=z9hG4bK1saber23
Call-ID: 0384840201234ksdfak3j2erwedfsASdf
CSeq: 35 INVITE
From: sip:user@example.com;tag=11141343
To: sip:user@example.edu;tag=2229
Content-Length: 159
Content-Type: application/sdp
Contact: <sip:user@host28.example.com>

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.198
s=-
c=IN IP4 192.0.2.198/127
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.11 Max-Forwards of zero
This is a legal SIP request with the Max-Forwards header field value
set to zero.
A proxy should not forward the request and respond 483 (Too Many
Hops). An endpoint should process the request as if the Max-Forwards
field value were still positive.
]]>
</description>
<message>
<![CDATA[

OPTIONS sip:user@example.com SIP/2.0
To: sip:user@example.com
From: sip:caller@example.net;tag=3ghsd41
Call-ID: 2304sadjfasdlfnm2o2l43r5u0asdfas
CSeq: 39234321 OPTIONS
Via: SIP/2.0/UDP host1.example.com;branch=z9hG4bKkdjuw2349i
Max-Forwards: 0
Content-Length: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.12 REGISTER with a contact header parameter
This register request contains a contact where the 'unknownparam'
parameter must be interpreted as being a contact-param and not a
url-param.
This REGISTER should succeed. The response must not include
"unknownparam" as a url-parameter for this binding. Likewise,
"unknownparam" must not appear as part of the binding during
subsequent fetches.
Behavior is the same, of course, for any known contact-param
parameter names.
]]>
</description>
<message>
<![CDATA[

REGISTER sip:example.com SIP/2.0
Via: SIP/2.0/UDP saturn.example.com:5060;branch=z9hG4bKkdjuw
Max-Forwards: 70
From: sip:watson@example.com;tag=DkfVgjkrtMwaerKKpe
To: sip:watson@example.com
Call-ID: 70710@saturn.example.com
CSeq: 2 REGISTER
Contact: sip:+19725552222@gw1.example.net;unknownparam
l: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.13 REGISTER with a url parameter
This register request contains a contact where the URI has an unknown
parameter.
The register should succeed and a subsequent retrieval of the
registration must include "unknownparam" as a url-parameter.
Behavior is the same, of course, for any known url-parameter names.
]]>
</description>
<message>
<![CDATA[

REGISTER sip:example.com SIP/2.0
Via: SIP/2.0/UDP saturn.example.com:5060;branch=z9hG4bKkdjuw
Max-Forwards: 70
From: sip:watson@example.com;tag=838293
To: sip:watson@example.com
Call-ID: 70710@saturn.example.com
CSeq: 3 REGISTER
Contact: <sip:+19725552222@gw1.example.net;unknownparam>
l: 0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.14 REGISTER with a url escaped header
This register request contains a contact where the URI has an escaped
header.
The register should succeed and a subsequent retrieval of the
registration must include the escaped Route header in the contact URI
for this binding.
]]>
</description>
<message>
<![CDATA[

REGISTER sip:example.com SIP/2.0
To: sip:user@example.com
From: sip:user@example.com;tag=8
Max-Forwards: 70
Call-ID: k345asrl3fdbv@192.0.2.1
CSeq: 14398234 REGISTER
Via: SIP/2.0/UDP host5.example.com;branch=z9hG4bKkdjuw
M: <sip:user@example.com?Route=%3Csip:sip.example.com%3E>
L:0

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.3.15 Unacceptable Accept offering
This request indicates the response must contain a body in an unknown
type. In particular, since the Accept header field does not contain
application/sdp, the response may not contain an SDP body. The
recipient of this request could respond with a 406 Not Acceptable
with a Warning/399 indicating that a response cannot be formulated in
the formats offered in the Accept header field. It is also
appropriate to respond with a 400 Bad Request since all SIP UAs
supporting INVITE are required to support application/sdp.
]]>
</description>
<message>
<![CDATA[

INVITE sip:user@example.com SIP/2.0
To: sip:j_user@example.com
Contact: <sip:caller@host15.example.net>
From: sip:caller@example.net;tag=234
Max-Forwards: 5
Call-ID: 0ha0isndaksdj9342dasdd
Accept: text/nobodyKnowsThis
CSeq: 8 INVITE
Via: SIP/2.0/UDP 192.0.2.15;branch=z9hG4bKkdjuw
Content-Length: 151
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.5
s=-
c=IN IP4 192.0.2.5
t=0 0
m=audio 492170 RTP/AVP 0 12
m=video 3227 RTP/AVP 31
a=rtpmap:31 LPC

]]>
</message>
</testcase>

<testcase>
<description>
<![CDATA[3.4.1 INVITE with RFC2543 syntax
This is a legal message per RFC 2543 (and several bis versions) which
should be accepted by RFC 3261 elements which want to maintain
backwards compatibility.
o  There is no branch parameter at all on the Via header field value
o  There is no From tag
o  There is no explicit Content-Length (The body is assumed to be all
  octets in the datagram after the null-line)
o  There is no Max-Forwards header field
]]>
</description>
<message>
<![CDATA[

INVITE sip:UserB@example.com SIP/2.0
Via: SIP/2.0/UDP iftgw.example.com
From: <sip:+13035551111@ift.client.example.net;user=phone>
Record-Route: <sip:UserB@example.com;maddr=ss1.example.com>
To: sip:+16505552222@ss1.example.net;user=phone
Call-ID: 1717@ift.client.example.com
CSeq: 56 INVITE
Content-Type: application/sdp

v=0
o=mhandley 29739 7272939 IN IP4 192.0.2.5
s=-
c=IN IP4 192.0.2.5
t=0 0
m=audio 492170 RTP/AVP 0

]]>
</message>
</testcase>


</torture>
